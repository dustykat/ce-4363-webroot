
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Groundwater Models &#8212; CE 4363/5363 Groundwater Hydrology</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Transient Groundwater Models" href="14gwmodels.html" />
    <link rel="prev" title="Groundwater Flow to Wells IV" href="../12gwflow2wells/12gwflow2wells.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo2.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">CE 4363/5363 Groundwater Hydrology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Welcome to CE 4363/5363 Groundwater Hydrology
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../00introduction/00introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01computationaltools/01computationaltools.html">
   Computational Tools
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02water/02water.html">
   Water (Fetter pp. 1-23)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03aquiferproperties/03aquiferproperties.html">
   Aquifer Properties - I (pp. 66-93)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04aquiferproperties/04aquiferproperties.html">
   Aquifer Properties - II (pp. 93-109)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../05gwflowprinciples/05gwflowprinciples.html">
   Groundwater Flow Principles (pp. 118 - 127)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../06gwflowequations/06gwflowequations.html">
   Groundwater Flow Equations (pp. 130-135; XX-XX)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../07gwflow1Dsolutions/07gwflow1Dsolutions.html">
   Groundwater Flow Solutions (pp. 143-151; 171-175)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../08gwflow2wells/08gwflow2wells.html">
   Groundwater Flow to Wells - I (pp. 156-162)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../09gwflow2wells/09gwflow2wells.html">
   Groundwater Flow to Wells - II (pp. 162 - 166)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../10gwflow2wells/10gwflow2wells.html">
   Groundwater Flow to Wells - III (pp. 172-212)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../11gwflow2wells/11gwflow2wells.html">
   Groundwater Flow to Wells - IV
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../12gwflow2wells/12gwflow2wells.html">
   Groundwater Flow to Wells IV
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="current reference internal" href="#">
   Groundwater Models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="14gwmodels.html">
     Transient Groundwater Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="15gwmodels.html">
     MODFLOW Program
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="16gwmodels.html">
     Regional Flow (pp. 244)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../16recharge.html">
   Recharge
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../17fieldmethods.html">
   Field Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../18waterwellconstruction.html">
   Water Well Construction - I
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../19waterwellconstruction.html">
   Water Well Construction - II
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../20gwchemistry.html">
   Groundwater Chemistry (pp. 351-392)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../21gwchemistry.html">
   Groundwater Chemistry - II
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../22gwcontamination.html">
   Groundwater Contamination - I
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../23gwcontamination.html">
   Groundwater Contamination - II
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../24contaminanttransport.html">
   Contaminant Transport
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../25gwdevelopment.html">
   Groundwater Development and Management
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../26waterlaw.html">
   Water Law
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/lessons/groundwatermodels/13gwmodels.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Flessons/groundwatermodels/13gwmodels.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/lessons/groundwatermodels/13gwmodels.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#storativity">
   Storativity
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#permeability">
   Permeability
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#head-loss-models">
   Head Loss Models
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#equilibrium-models">
   Equilibrium Models
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#confined-aquifer-flow-modeling-theory">
   Confined Aquifer Flow Modeling Theory
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solution-methods">
   Solution Methods
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finite-difference-methods-1-spatial-dimension">
     Finite-Difference Methods – 1 Spatial Dimension
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finite-difference-methods-2-spatial-dimensions">
     Finite-Difference Methods – 2 Spatial Dimensions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#homebrew-example-1">
     Homebrew - Example 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#homebrew-example-2">
     Homebrew - Example 2
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#generalizing-the-boundary-conditions">
   Generalizing the Boundary Conditions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#contour-plotting">
   Contour Plotting
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#homebrew-example-3-pore-pressure-under-a-dam">
     Homebrew - Example 3: Pore Pressure under a Dam
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#homebrew-example-4-pore-pressure-under-a-dam-domain-decomposition-approach">
     Homebrew - Example 4 : Pore Pressure under a Dam (Domain Decomposition approach)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#homebrew-example-5-wells-in-a-rectangular-aquifer">
     Homebrew - Example 5: Wells in a rectangular aquifer
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#unconfined-aquifer-flow">
   Unconfined Aquifer Flow
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#homebrew-example-6-wells-in-a-rectangular-unconfined-aquifer">
     Homebrew - Example 6: Wells in a rectangular unconfined aquifer
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interim-summary">
   Interim Summary
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="groundwater-models">
<h1>Groundwater Models<a class="headerlink" href="#groundwater-models" title="Permalink to this headline">¶</a></h1>
<p>Flow in porous media is a topic that appears in many branches of engineering and science, e.g., ground water hydrology, reservoir engineering, soil science, soil mechanics, and chemical engineering (filtration).
The aquifer, which is the porous medium domain of the hydrologist, or the oil reservoir, which is the porous medium of the petroleum engineer are typical examples. <a class="reference internal" href="#aquifers"><span class="std std-numref">Fig. 14</span></a> is a sketch of different aquifer classifications.</p>
<div class="figure align-default" id="aquifers">
<a class="reference internal image-reference" href="../../_images/aquifers.png"><img alt="../../_images/aquifers.png" src="../../_images/aquifers.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 14 </span><span class="caption-text">Aquifer Schematic</span><a class="headerlink" href="#aquifers" title="Permalink to this image">¶</a></p>
</div>
<p>A confined aquifer (pressure aquifer) is one bounded above and below by impermeable formations.
In a well penetrating such an aquifer, the water level will rise above the base of the confining formation.
Water levels in wells that sample a certain aquifer define an imaginary surface called the piezometric surface.</p>
<p>An unconfined aquifer (water table aquifer; phreatic aquifer) is one with the water table as its upper boundary.
The classifications are important because the equations of motion are different in different kinds of aquifers.</p>
<div class="section" id="storativity">
<h2>Storativity<a class="headerlink" href="#storativity" title="Permalink to this headline">¶</a></h2>
<p>Storativity of an aquifer is the relationship between changes in head within the aquifer and the quantity of water stored in the aquifer.  The dominant mechanism of storage is different for confined and unconfined aquifers. <a class="reference internal" href="#storage"><span class="std std-numref">Fig. 15</span></a> is a sketch depicting the storage process in a confined, and an unconfined aquifer.</p>
<div class="figure align-default" id="storage">
<a class="reference internal image-reference" href="../../_images/storage.png"><img alt="../../_images/storage.png" src="../../_images/storage.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 15 </span><span class="caption-text">Storage Mechanisms</span><a class="headerlink" href="#storage" title="Permalink to this image">¶</a></p>
</div>
<p>In a confined aquifer the water is stored or released by compression and decompression of water and the solid matrix (like a sponge squeezed while wrapped in plastic wrap).  In an unconfined aquifer the water is stored or released from the pore space when the water table elevation changes.</p>
<p>The storage coefficient (confined) or specific yield (unconfined) is the volume of water added to (or removed from) storage per unit area of aquifer per unit change in head.  The usual symbols are <span class="math notranslate nohighlight">\(S\)</span>, and <span class="math notranslate nohighlight">\(S_y\)</span>.</p>
</div>
<div class="section" id="permeability">
<h2>Permeability<a class="headerlink" href="#permeability" title="Permalink to this headline">¶</a></h2>
<p>Permeability is the material property that relates the resistance of flow through the porous medium to the hydraulic gradient.</p>
</div>
<div class="section" id="head-loss-models">
<h2>Head Loss Models<a class="headerlink" href="#head-loss-models" title="Permalink to this headline">¶</a></h2>
<p>Darcy’s law (a linear flux model) is the head loss model used for porous media flow.</p>
<p>Darcy’s law is usually presented as a discharge model</p>
<div class="math notranslate nohighlight">
\[Q = -KA\frac{\Delta h}{\Delta x}\]</div>
<p>Expressed as a head loss model it is rearranged as</p>
<div class="math notranslate nohighlight">
\[
h_L = \frac{QL}{KA}
\]</div>
<p>where <span class="math notranslate nohighlight">\(Q\)</span> is the discharge in the aquifer, <span class="math notranslate nohighlight">\(L\)</span> is the length in the flow direction, <span class="math notranslate nohighlight">\(A\)</span> is the cross sectional area of aquifer (pore space and solid phase), <span class="math notranslate nohighlight">\(K\)</span> is the hydraulic conductivity (sometimes called the permeability).</p>
<p>A more useful (for computation) form of the head loss model, is to express it (the loss equation) as an equation of motion as in</p>
<div class="math notranslate nohighlight">
\[Q = -KA\frac{\partial h}{\partial x}\]</div>
<p>where <span class="math notranslate nohighlight">\(- \frac{\partial h}{\partial x}\)</span> is the hydraulic gradient (slope of the hydraulic grade line) in the aquifer.</p>
<p><a class="reference internal" href="#d-aquifer-flow"><span class="std std-numref">Fig. 16</span></a> is a diagram that illustrates the relationships expressed by Darcy’s law.</p>
<div class="figure align-default" id="d-aquifer-flow">
<a class="reference internal image-reference" href="../../_images/1D-aquifer-flow.png"><img alt="../../_images/1D-aquifer-flow.png" src="../../_images/1D-aquifer-flow.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 16 </span><span class="caption-text">Schematic diagram of unidirectional flow in a generic aquifer, showing heads in two measuring wells located distance <span class="math notranslate nohighlight">\(L\)</span> apart</span><a class="headerlink" href="#d-aquifer-flow" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p>The cross-sectional flow area, <span class="math notranslate nohighlight">\(A\)</span>, is the product of height of the aquifer block and its width (in this case the width is into the plane of the paper).</p></li>
<li><p>The distance between two measurement points is <span class="math notranslate nohighlight">\(L\)</span>. The head at the two points is <span class="math notranslate nohighlight">\(h_1\)</span> and <span class="math notranslate nohighlight">\(h_2\)</span>.</p></li>
<li><p>The gradient of head, <span class="math notranslate nohighlight">\(\frac{\partial h}{\partial x}\)</span>, is <span class="math notranslate nohighlight">\(\frac{h_2 - h_1}{L}\)</span>.</p></li>
<li><p>The hydraulic gradient is  <span class="math notranslate nohighlight">\(- \frac{\partial h}{\partial x}\)</span>, is <span class="math notranslate nohighlight">\(\frac{h_1 - h_2}{L}\)</span>.</p></li>
</ul>
<p>Finally Darcy’s law (for the drawing) is <span class="math notranslate nohighlight">\(Q = K A \frac{h_1 - h_2}{L}\)</span>.</p>
</div>
<div class="section" id="equilibrium-models">
<h2>Equilibrium Models<a class="headerlink" href="#equilibrium-models" title="Permalink to this headline">¶</a></h2>
<p>Equilibrium models imply that the head distribution is constant in time.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Steady-state is a common, thermodynamically incorrect way to refer to an equilibrium model.  Keep in mind, flow is non zero, hence the flow is steady, but the thermodynamic state of the system is not.  It’s an almost trivial point - but relevant when the model is used for geochemistry explaination.</p>
</div>
</div>
<div class="section" id="confined-aquifer-flow-modeling-theory">
<h2>Confined Aquifer Flow Modeling Theory<a class="headerlink" href="#confined-aquifer-flow-modeling-theory" title="Permalink to this headline">¶</a></h2>
<p>Using Figure <a class="reference internal" href="#d-aquifer-flow"><span class="std std-numref">Fig. 16</span></a> as a starting point, one can develop a computational model of flow in a confined aquifer.
Let’s decide that the distance <span class="math notranslate nohighlight">\(L\)</span> in the figure is going to be divided into a series of connected, small blocks.
The flow direction in the figure will be declared  the <span class="math notranslate nohighlight">\(x\)</span> direction, the depth into the drawing is declared the <span class="math notranslate nohighlight">\(y\)</span> direction, and the height of the block is declared the <span class="math notranslate nohighlight">\(z\)</span> direction.</p>
<p><a class="reference internal" href="#single-computational-cell"><span class="std std-numref">Fig. 17</span></a> is a diagram of one such small block.</p>
<div class="figure align-default" id="single-computational-cell">
<a class="reference internal image-reference" href="../../_images/single-computational-cell.png"><img alt="../../_images/single-computational-cell.png" src="../../_images/single-computational-cell.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 17 </span><span class="caption-text">Single computational cell definition sketch</span><a class="headerlink" href="#single-computational-cell" title="Permalink to this image">¶</a></p>
</div>
<p>Using this diagram we can now develop a set of expressions for the cell volume, solids volume in the cell,  pore volume in the cell (where water actually can flow), and solids mass.</p>
<p>First some definitional expressions for each cell:</p>
<blockquote>
<div><ul class="simple">
<li><p>Cell Volume: <span class="math notranslate nohighlight">\(V_{cell} = \Delta x \times \Delta y \times \Delta z\)</span></p></li>
<li><p>Solids Volume: <span class="math notranslate nohighlight">\(V_{solid} =(1-\omega) \Delta x \times \Delta y \times \Delta z\)</span></p></li>
<li><p>Void (Pore) Volume: <span class="math notranslate nohighlight">\(V_{pore} = \omega \Delta x \times \Delta y \times \Delta z\)</span></p></li>
<li><p>Solids Mass: <span class="math notranslate nohighlight">\(M_{solid} = \rho_{s} (1-\omega) \Delta x \times \Delta y \times \Delta z\)</span></p></li>
</ul>
</div></blockquote>
<p>Next write a mass balance for water in the cell;</p>
<div class="math notranslate nohighlight">
\[
\frac{d M_{water}}{dt} = M_{Inflow} - M_{Outlfow}
\]</div>
<p>The left side of the expression is simply the storage term, and in the context of storage coefficients and aquifer head is replaced by</p>
<div class="math notranslate nohighlight">
\[
{\frac{d M_{water}}{dt}\mid}_{cell} =\rho_{w} S_{s} \Delta x \Delta y \Delta z \frac{\partial h_i}{\partial t}
\]</div>
<p>where <span class="math notranslate nohighlight">\(h_i\)</span> is the head in the <span class="math notranslate nohighlight">\(i-\)</span>th cell.</p>
<p>The right hand side of the expression is based on writing Darcy’s law for the cell, and using values in adjacent (hydraulically connected) cells.</p>
<p><a class="reference internal" href="#multiple-computational-cell"><span class="std std-numref">Fig. 18</span></a> is a diagram of three such connected blocks.</p>
<div class="figure align-default" id="multiple-computational-cell">
<a class="reference internal image-reference" href="../../_images/multiple-computational-cell.png"><img alt="../../_images/multiple-computational-cell.png" src="../../_images/multiple-computational-cell.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 18 </span><span class="caption-text">Multiple computational cell definition sketch</span><a class="headerlink" href="#multiple-computational-cell" title="Permalink to this image">¶</a></p>
</div>
<p>The <span class="math notranslate nohighlight">\(i-\)</span>th cell is the cell of interest, the cell to the left is cell ID <span class="math notranslate nohighlight">\(i-1\)</span>, and the cell to the right is cell ID <span class="math notranslate nohighlight">\(i+1\)</span>.</p>
<p>We now write Darcy’s law for each face of cell <span class="math notranslate nohighlight">\(i\)</span>, treating the head in each of the cell centers as if they were the sampling wells of <a class="reference internal" href="#d-aquifer-flow"><span class="std std-numref">Fig. 16</span></a> (In the context of <a class="reference internal" href="#d-aquifer-flow"><span class="std std-numref">Fig. 16</span></a>, the cell face is halfway between the two wells; the cell centers are at the wells.)</p>
<p>Darcy’s law for the left face is</p>
<div class="math notranslate nohighlight">
\[
M_{Inflow} = Q_{left} =\rho_{w} K \Delta y \Delta z \frac{h_{i-1} - h_{i}}{\Delta x}
\]</div>
<p>Similarly for the right face,</p>
<div class="math notranslate nohighlight">
\[
M_{Outflow} = Q_{right} =\rho_{w} K \Delta y \Delta z \frac{h_{i} - h_{i+1}}{\Delta x}
\]</div>
<p>Now combine these together in the mass balance</p>
<div class="math notranslate nohighlight">
\[
\rho_{w} S_{s} \Delta x \Delta y \Delta z \frac{\partial h_i}{\partial t} = 
(\rho_{w} K \Delta y \Delta z \frac{h_{i-1} - h_{i}}{\Delta x}) - 
(\rho_{w} K \Delta y \Delta z \frac{h_{i} - h_{i+1}}{\Delta x})
\]</div>
<p>Next divide by the water density <span class="math notranslate nohighlight">\(\rho_{w}\)</span>,</p>
<div class="math notranslate nohighlight">
\[
S_{s} \Delta x \Delta y \Delta z \frac{\partial h_i}{\partial t} = 
(K \Delta y \Delta z \frac{h_{i-1} - h_{i}}{\Delta x}) - 
(K \Delta y \Delta z \frac{h_{i} - h_{i+1}}{\Delta x})  
\]</div>
<p>Then divide by cell width <span class="math notranslate nohighlight">\(\Delta y \)</span>,</p>
<div class="math notranslate nohighlight">
\[
S_{s} \Delta x \Delta z \frac{\partial h_i}{\partial t} = 
(K  \Delta z \frac{h_{i-1} - h_{i}}{\Delta x}) - 
(K  \Delta z \frac{h_{i} - h_{i+1}}{\Delta x})
\]</div>
<p>Rewrite the right hand side into gradient of head form</p>
<div class="math notranslate nohighlight">
\[
S_{s} \Delta x \Delta z \frac{\partial h_i}{\partial t} = 
(K \Delta z \frac{h_{i+1} - h_{i}}{\Delta x}) - 
(K \Delta z \frac{h_{i} - h_{i-1}}{\Delta x})
= 
{K \Delta z \frac{\partial h}{\partial x}}\mid_{i~\rightarrow i+1} -
{K \Delta z \frac{\partial h}{\partial x}}\mid_{i-1~\rightarrow i}
\]</div>
<p>Divide by cell distance, <span class="math notranslate nohighlight">\(\Delta x\)</span>,</p>
<div class="math notranslate nohighlight">
\[
S_{s}  \Delta z \frac{\partial h_i}{\partial t} = 
\frac{{K \Delta z \frac{\partial h}{\partial x}}\mid_{i~\rightarrow i+1} -
{K \Delta z\frac{\partial h}{\partial x}}\mid_{i-1~\rightarrow i}}{\Delta x}
\]</div>
<p>Take limit as <span class="math notranslate nohighlight">\(\Delta x~\rightarrow0\)</span>,</p>
<div class="math notranslate nohighlight">
\[
S_{s} \Delta z  \frac{\partial h}{\partial t} = 
\frac{\partial}{\partial x}({K \Delta z \frac{\partial h}{\partial x}})
\]</div>
<p>Finally, stipulate that <span class="math notranslate nohighlight">\(S_{s} \Delta z = S\)</span>, the storage coefficient (for confined aquifer), and define the aquifer transmissivity as <span class="math notranslate nohighlight">\(K \Delta z = T\)</span> and we have performed a nicely back-handed way to get the partial differential equation of aquifer flow.</p>
<div class="math notranslate nohighlight">
\[
S \frac{\partial h}{\partial t} = 
\frac{\partial}{\partial x}({T \frac{\partial h}{\partial x}})
\]</div>
</div>
<div class="section" id="solution-methods">
<h2>Solution Methods<a class="headerlink" href="#solution-methods" title="Permalink to this headline">¶</a></h2>
<p>Ironically, the analysis actually provides an algorithm to approximate head in the aquifer</p>
<div class="section" id="finite-difference-methods-1-spatial-dimension">
<h3>Finite-Difference Methods – 1 Spatial Dimension<a class="headerlink" href="#finite-difference-methods-1-spatial-dimension" title="Permalink to this headline">¶</a></h3>
<p>Here we will use the equation obtained after dividing by the water density as a starting point for simulating aquifer behavior.</p>
<p>As a first model, lets consider the steady flow situation, in which case the left hand side vanishes (there is no change in storage).</p>
<div class="math notranslate nohighlight">
\[
0 = 
(K \Delta y \Delta z \frac{h_{i-1} - h_{i}}{\Delta x}) - 
(K \Delta y \Delta z \frac{h_{i} - h_{i+1}}{\Delta x})
\]</div>
<p>Next we will use the arithmetic mean values of the material properties (<span class="math notranslate nohighlight">\(K\)</span>) at the cell interfaces, so the difference equation becomes</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Other spatial averaging formulas are employed, but the arithmetic mean is quite common</p>
</div>
<div class="math notranslate nohighlight">
\[
0 = 
(\frac{1}{2}(K_{i-1}+K_{i}) \Delta y \Delta z \frac{h_{i-1} - h_{i}}{\Delta x}) - 
(\frac{1}{2}(K_{i}+K_{i-1}) \Delta y \Delta z \frac{h_{i} - h_{i+1}}{\Delta x})
\]</div>
<p>Now lets group some constants:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{matrix}
A_{i} = \frac{1}{2 \Delta x}(K_{i-1}+K_{i}) \Delta y \Delta z \\
B_{i} = \frac{1}{2 \Delta x}(K_{i}+K_{i+1}) \Delta y \Delta z
\end{matrix}
\end{split}\]</div>
<p>Now substitute into the difference equation</p>
<div class="math notranslate nohighlight">
\[
0 = A_{i}(h_{i-1}) -(A_{i}+B_{i})(h_{i}) + B_{i}(h_{i+1})
\]</div>
<p>Now all that remains is to specify boundary conditions, and then implement an algorithm to solve the resulting system of algebraic equations.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>I have assumed that the spatial step, <span class="math notranslate nohighlight">\(\Delta x\)</span> is the same for each cell – it doesn’t have to be, but relaxing that assumption complicates the specifications of the constants <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>.</p>
</div>
<p>Some of the plausible boundary conditions are:</p>
<ol class="simple">
<li><p>Specified head boundary (pretty easy to specify in a computer representation).</p></li>
<li><p>Zero-flux boundary (also easy to specify using the cell-centered formulation herein).</p></li>
<li><p>Specified flux boundary (using a modeling trick not too hard to specify).</p></li>
</ol>
<p>These three types of conditions should handle the majority of practical situations where one would need to model an aquifer system.</p>
<p>Lets examine the difference equation a little bit – assume we have the correct values then</p>
<div class="math notranslate nohighlight">
\[
h_{i} = \frac{A_{i}(h_{i-1}) + B_{i}(h_{i+1})}{(A_{i}+B_{i})}
\]</div>
<p>which suggests a nice algorithm.</p>
<p>We will simply apply boundary conditions, then evaluate the expression for each cell, and after we compute the expression for all the cells, we will repeat the process until the solution stops changing.</p>
<p>Computationally, we are employing a Jacobi iteration scheme, which will work nicely for this particular problem structure.<br />
An alternative, equally valid, would be to construct the linear system of equations (in this case it will be a three-banded matrix), and apply an appropriate row reduction technique to find the solution.</p>
<p>The example 1D applications are presented below as special cases of 2D models.</p>
</div>
<div class="section" id="finite-difference-methods-2-spatial-dimensions">
<h3>Finite-Difference Methods – 2 Spatial Dimensions<a class="headerlink" href="#finite-difference-methods-2-spatial-dimensions" title="Permalink to this headline">¶</a></h3>
<p>If we perform an analysis in the same way as we did to arrive at</p>
<div class="math notranslate nohighlight">
\[
S \frac{\partial h}{\partial t} = 
\frac{\partial}{\partial x}({T \frac{\partial h}{\partial x}})
\]</div>
<p>except now include another direction (the y-direction) we will have an aquifer in two spatial
dimensions. The governing equation becomes</p>
<div class="math notranslate nohighlight">
\[
S \frac{\partial h}{\partial t} = 
\frac{\partial}{\partial x}({T_x \frac{\partial h}{\partial x}}) +
\frac{\partial}{\partial y}({T_y \frac{\partial h}{\partial y}})
\]</div>
<p>The meanings of the terms are the same, except the transmissivity terms now have
subscripts to indicate they can have different values depending on direction</p>
<p>Then as before we will construct the difference-equation model from a multiple-cell
balance model of the aquifer at a cell of interest, then extend the equations to cover
the entire model domain.</p>
<div class="figure align-default" id="d-cell">
<a class="reference internal image-reference" href="../../_images/2D-cell.png"><img alt="../../_images/2D-cell.png" src="../../_images/2D-cell.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 19 </span><span class="caption-text">Plan view schematic of 2-dimensional multiple cell balance computational stencil.</span><a class="headerlink" href="#d-cell" title="Permalink to this image">¶</a></p>
</div>
<p><a class="reference internal" href="#d-cell"><span class="std std-numref">Fig. 19</span></a> is a plan view schematic of a aquifer with flow to be computed in two
directions (x and y). The cell indexing convention in the sketch is that rows are in-
dexed by the letter j and columns are indexed by the letter i. This naming convention
is arbitrary; in some instances it may be preferable to reverse the convention. The
schematic also shows the assumed flow directions; for column i, flows are upward in
the drawing, and for row j, flows are from left to right. If indeed the opposite is true
for a given set of boundary conditions and material properties, then the flows will be
computed as negative numbers – hence the convention here is that “positive flow” is
right and up.</p>
<p>As in the one-dimensional development the storage term is</p>
<div class="math notranslate nohighlight">
\[
\frac{dM_{water}}{dt}\mid_cell = \rho_w S_s \Delta x \Delta y \Delta z \frac{\partial h_{i,j}}{\partial t} (218)
\]</div>
<p>where <span class="math notranslate nohighlight">\(h_{i,j}\)</span> is the head in the (i−th, j−th) cell.</p>
<p>The mass flows <strong>entering</strong> the (i−th, j−th) cell are:</p>
<div class="math notranslate nohighlight">
\[
M_{Inflow} = Q_{left} + Q_{bottom} = \rho_w K_x\Delta y\Delta z \frac{h_{i−1,j} − h_{i,j}}{∆x} + \rho_w K_y \Delta x \Delta z \frac{h_{i,j−1} − h_{i,j}}{\Delta y}
\]</div>
<p>The mass flows <strong>leaving</strong> the (i − th, j − th} cell are:</p>
<div class="math notranslate nohighlight">
\[
M_{Outflow} = Q_{right} + Q_{top} = \rho_w K_x\Delta y\Delta z \frac{h_{i,j} − h_{i+1,j}}{\Delta x} + \rho_w K_y \Delta x \Delta z \frac{h_{i,j} − h_{i,j+1}}{\Delta y} 
\]</div>
<p>Now write the entire balance equation</p>
<div class="math notranslate nohighlight">
\[
\rho_w S_s \Delta x \Delta y \Delta z \frac{\partial h_{i,j}}{\partial t}=
[\rho_w K_x\Delta y\Delta z \frac{h_{i−1,j} − h_{i,j}}{∆x} + \rho_w K_y \Delta x \Delta z \frac{h_{i,j−1} − h_{i,j}}{\Delta y}]−[\rho_w K_x\Delta y\Delta z \frac{h_{i,j} − h_{i+1,j}}{\Delta x} + \rho_w K_y \Delta x \Delta z \frac{h_{i,j} − h_{i,j+1}}{\Delta y} ]
\]</div>
<p>Next replace <span class="math notranslate nohighlight">\(S_s \Delta z\)</span> with the storage coefficient <span class="math notranslate nohighlight">\(S\)</span>, and the <span class="math notranslate nohighlight">\(K_{x,y}\Delta z\)</span> with the transmissivity T_{x,y} terms, and divide by the density of the fluid and the cell plan view area
<span class="math notranslate nohighlight">\(\Delta x \Delta y\)</span> to obtain a more compact form of the difference equation.</p>
<div class="math notranslate nohighlight">
\[
S \frac{\partial h_{i,j}}{\partial t} = [ \frac{1}{\Delta x} T_x \frac{h_{i−1,j} − h_{i,j}}{\Delta x}
+ \frac{1}{\Delta y} T_y \frac{h_{i,j-1} − h_{i,j}}{\Delta y}]-[\frac{1}{\Delta x} T_x \frac{h_{i,j} − h_{i+1,j}}{\Delta x} + \frac{1}{\Delta y} T_y \frac{h_{i,j} − h_{i,j+1}}{\Delta y}]
\]</div>
<p>As in the one-dimensional case, lets again consider steady flow (we will do transient
flows later on)</p>
<div class="math notranslate nohighlight">
\[
0 = [ \frac{1}{\Delta x} T_x \frac{h_{i−1,j} − h_{i,j}}{\Delta x}
+ \frac{1}{\Delta y} T_y \frac{h_{i,j-1} − h_{i,j}}{\Delta y}]-[\frac{1}{\Delta x} T_x \frac{h_{i,j} − h_{i+1,j}}{\Delta x} + \frac{1}{\Delta y} T_y \frac{h_{i,j} − h_{i,j+1}}{\Delta y}]
\]</div>
<p>Also as in the one-dimensional case, we will approximate the spatial variation of the
material properties (transmissivity) as arithmetic mean values between two cells, so
making the following definitions:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A_{i,j} = \frac{1}{2∆x^2} (T_{x,(i−1,j)} + T_{x,(i,j)})\\
B_{i,j} = \frac{1}{2∆x^2} (T_{x,(i,j)} + T_{x,(i+1,j)})\\
C_{i,j} = \frac{1}{2∆y^2} (T_{y,(i,j−1)} + T_{y,(i,j)})\\
D_{i,j} = \frac{1}{2∆y^2} (T_{y,(i,j)} + T_{y,(i,j+1)})\\
\end{split}\]</div>
<p>Substitution into the difference equation yields</p>
<div class="math notranslate nohighlight">
\[
0 = A_{i,j} h_{i−1,j} + B_{i,j} h_{i+1,j} − (A_{i,j} + B_{i,j} + C_{i,j} + D_{i,j} )h_{i,j} + C_{i,j} h_{i,j−1} + D_{i,j} h_{i,j+1}
\]</div>
<p>As before we can explicitly write the cell equation for hi,j as</p>
<div class="math notranslate nohighlight">
\[
h_{i,j} = \frac{A_{i,j} h_{i−1,j} + B_{i,j} h_{i+1,j} + C_{i,j} h_{i,j−1} + D_{i,j} h_{i,j+1}}{A_{i,j} + B_{i,j} + C_{i,j} + D_{i,j} } 
\]</div>
<p>This difference equation represents an approximation to the governing flow equation,
the accuracy depending on the cell size. Boundary conditions are applied directly into
the analogs (another name for the difference equations) at appropriate locations on
the computational grid. Also as in the one-dimensional case we can generate solutions
either by iteration or solving the resulting linear system.</p>
</div>
<div class="section" id="homebrew-example-1">
<h3>Homebrew - Example 1<a class="headerlink" href="#homebrew-example-1" title="Permalink to this headline">¶</a></h3>
<p><strong>2D Steady Flow in a Confined Aquifer using Jacobi Iteration</strong>
We will start the example with a simple physical condition and use Jacobi iteration to obtain a solution. We will also incorporate two kinds of boundary conditions (fixed head, and no-flow boundaries).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Jacobi iteration for large domain problems (say 200x200) or bigger, is pretty inefficient – better iterative methods are available; however they simply represent clever changes to the basic iteration methods explained here, hence Jacobi is a good place to start, and is incredibly easy to program.</p>
</div>
<div class="figure align-default" id="d-aquifer">
<a class="reference internal image-reference" href="../../_images/2D-aquifer.png"><img alt="../../_images/2D-aquifer.png" src="../../_images/2D-aquifer.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 20 </span><span class="caption-text">Plan view schematic of 2-dimensional multiple cell balance computational stencil.</span><a class="headerlink" href="#d-aquifer" title="Permalink to this image">¶</a></p>
</div>
<p><a class="reference internal" href="#d-aquifer"><span class="std std-numref">Fig. 20</span></a> is a schematic of this example. The right panel of the figure shows the index naming convention. The known material properties are transmissivity (in each direction, at each cell center, and the thickness of the aquifer (b == ∆z).
Our task is to simulate the aquifer with the 5 x 5 model shown. The left and right boundaries will be treated as specified head boundaries. The upper and lower boundary will be treated as no flow boundaries.
The head on the left is 100 meters and the right is 60 meters (same as before). The transmissivity (<span class="math notranslate nohighlight">\(K_{x,y}\Delta z=10\)</span>) square meters per second for this exampls suppose <span class="math notranslate nohighlight">\(K = 0.2\)</span> meters per second, and <span class="math notranslate nohighlight">\(\Delta z = 50\)</span> meters. The
spatial dimensions are <span class="math notranslate nohighlight">\(\Delta x = 100\)</span> meters and <span class="math notranslate nohighlight">\(\Delta y = 100\)</span> meters</p>
<p>The listing below implements the method – in this case there are data read/write methods (to read and build matrices), and notice how the no-flow boundary conditions are implemented.</p>
<p>The data are stored in an input file to generalize the script</p>
<p><strong>input1.txt</strong> contents:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">100</span>
<span class="mi">100</span>
<span class="mi">50</span>
<span class="mi">5</span>
<span class="mi">5</span>
<span class="mf">1e-4</span>
<span class="mi">100</span>
<span class="mi">100</span> <span class="mi">200</span> <span class="mi">300</span> <span class="mi">400</span> <span class="mi">500</span>
<span class="mi">100</span> <span class="mi">200</span> <span class="mi">300</span> <span class="mi">400</span> <span class="mi">500</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">60</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">60</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">60</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">60</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">60</span>
<span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span>
<span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span>
<span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span>
<span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span>
<span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span>
<span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span>
<span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span>
<span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span>
<span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span>
<span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span> <span class="mf">0.2</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sse</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">sse</span><span class="o">=</span><span class="mf">0.0</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">sse</span><span class="o">=</span><span class="n">sse</span><span class="o">+</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">-</span><span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span><span class="p">(</span><span class="n">sse</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">=</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span>
    <span class="k">return</span><span class="p">(</span><span class="n">matrix2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">writearray</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="n">new_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>    
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">new_list</span><span class="p">[</span><span class="n">ir</span><span class="p">][:])</span>
    <span class="k">return</span><span class="p">()</span>

<span class="n">localfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;input1.txt&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="c1"># connect and read file for 2D gw model</span>
<span class="n">deltax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltay</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltaz</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">tolerance</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">maxiter</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">distancex</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancex</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">distancey</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancey</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">head</span> <span class="o">=</span><span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">head</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">hydcondx</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondx</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">hydcondy</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondy</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">localfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="c1"># Disconnect the file</span>
<span class="c1">##</span>
<span class="n">amat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">bmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">cmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">dmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="c1">##</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">##</span>
<span class="n">headold</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span> <span class="c1">#force new matrix</span>
<span class="n">headold</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span> <span class="c1"># update</span>
<span class="c1">##writearray(head)</span>
<span class="c1">##print(&quot;----&quot;)</span>
<span class="c1">##writearray(headold)</span>
<span class="c1">##print(&quot;--------&quot;)</span>
<span class="n">tolflag</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">for</span> <span class="nb">iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxiter</span><span class="p">):</span>
<span class="c1">##    print(&quot;begin iteration&quot;)</span>
<span class="c1">##    writearray(head)</span>
<span class="c1">##    print(&quot;----&quot;)</span>
<span class="c1">##    writearray(headold)</span>
<span class="c1">##    print(&quot;--------&quot;)</span>
<span class="c1"># first and last row special == no flow boundaries</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="n">head</span> <span class="p">[</span><span class="mi">0</span>    <span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
        <span class="n">head</span> <span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
<span class="c1"># interior updates</span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="p">(</span> <span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                              <span class="o">+</span><span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                              <span class="o">+</span><span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
                              <span class="o">+</span><span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">amat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">bmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">cmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">dmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">])</span>
<span class="c1"># test for stopping iterations</span>
<span class="c1">##    print(&quot;end iteration&quot;)</span>
<span class="c1">##    writearray(head)</span>
<span class="c1">##    print(&quot;----&quot;)</span>
<span class="c1">##    writearray(headold)</span>
    <span class="n">percentdiff</span> <span class="o">=</span> <span class="n">sse</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span>
    <span class="k">if</span>  <span class="n">percentdiff</span> <span class="o">&lt;=</span> <span class="n">tolerance</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exit iterations in velocity potential because tolerance met &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations =&quot;</span> <span class="p">,</span> <span class="nb">iter</span><span class="o">+</span><span class="mi">1</span> <span class="p">)</span> <span class="p">;</span>
        <span class="n">tolflag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">break</span>
    <span class="n">headold</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;End Calculations&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations    = &quot;</span><span class="p">,</span><span class="nb">iter</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Closure Error = &quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">percentdiff</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Head Map&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
<span class="n">writearray</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exit iterations in velocity potential because tolerance met 
Iterations = 31
End Calculations
Iterations    =  31
Closure Error =  0.0
Head Map
----
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0 [100.  90.  80.  70.  60.]
1 [100.  90.  80.  70.  60.]
2 [100.  90.  80.  70.  60.]
3 [100.  90.  80.  70.  60.]
4 [100.  90.  80.  70.  60.]
----
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="homebrew-example-2">
<h3>Homebrew - Example 2<a class="headerlink" href="#homebrew-example-2" title="Permalink to this headline">¶</a></h3>
<p><strong>2D Vertical Slice in a Confined Aquifer using Jacobi Iteration with Low Permeability Inclusion</strong>
<a class="reference internal" href="#lowkinclusion"><span class="std std-numref">Fig. 21</span></a> is a schematic of a different situation that now only requires us to change
the contents of the data file, and re-run the scripts unchanged.</p>
<div class="figure align-default" id="lowkinclusion">
<a class="reference internal image-reference" href="../../_images/lowKinclusion.png"><img alt="../../_images/lowKinclusion.png" src="../../_images/lowKinclusion.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 21 </span><span class="caption-text">Plan view schematic of 2-dimensional multiple cell balance computational stencil.</span><a class="headerlink" href="#lowkinclusion" title="Permalink to this image">¶</a></p>
</div>
<p>The input file is listed below. The boundary conditions are still directly coded into the algorithm, and that would be a useful modification to the code - general boundary condition information.  Another useful addition is to generate graphical output, as the model size increases the output is harder to interpret - a contour map would be quite useful!</p>
<p><strong>input2.txt</strong> contents</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>
<span class="mi">10</span>
<span class="mi">1</span>
<span class="mi">13</span>
<span class="mi">23</span>
<span class="mf">1e-9</span> 
<span class="mi">9000</span>
<span class="mi">5</span> <span class="mi">15</span> <span class="mi">25</span> <span class="mi">35</span> <span class="mi">45</span> <span class="mi">55</span> <span class="mi">65</span> <span class="mi">75</span> <span class="mi">85</span> <span class="mi">95</span> <span class="mi">105</span> <span class="mi">115</span> <span class="mi">125</span> <span class="mi">135</span> <span class="mi">145</span> <span class="mi">155</span> <span class="mi">165</span> <span class="mi">175</span> <span class="mi">185</span> <span class="mi">195</span> <span class="mi">205</span> <span class="mi">215</span> <span class="mi">225</span>
<span class="mf">0.5</span> <span class="mf">1.5</span> <span class="mf">2.5</span> <span class="mf">3.5</span> <span class="mf">4.5</span> <span class="mf">5.5</span> <span class="mf">6.5</span> <span class="mf">7.5</span> <span class="mf">8.5</span> <span class="mf">9.5</span> <span class="mf">10.5</span> <span class="mf">11.5</span> <span class="mf">12.5</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">90</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">90</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">90</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">90</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">90</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">90</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">90</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">90</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">90</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">90</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">90</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">90</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">90</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sse</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">sse</span><span class="o">=</span><span class="mf">0.0</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">sse</span><span class="o">=</span><span class="n">sse</span><span class="o">+</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">-</span><span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span><span class="p">(</span><span class="n">sse</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="c1">##print(nr,nc)</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="c1">##print(ir,jc)</span>
            <span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">=</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span>
    <span class="k">return</span><span class="p">(</span><span class="n">matrix2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">writearray</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="n">new_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>    
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">new_list</span><span class="p">[</span><span class="n">ir</span><span class="p">][:])</span>
    <span class="k">return</span><span class="p">()</span>

<span class="n">localfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;input2.txt&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="c1"># connect and read file for 2D gw model</span>
<span class="n">deltax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltay</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltaz</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">tolerance</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">maxiter</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">distancex</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancex</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">distancey</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancey</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">head</span> <span class="o">=</span><span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">head</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">hydcondx</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondx</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">hydcondy</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondy</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">localfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="c1"># Disconnect the file</span>
<span class="c1">##</span>
<span class="n">amat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">bmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">cmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">dmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="c1">##</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">##</span>
<span class="n">headold</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span> <span class="c1">#force new matrix</span>
<span class="n">headold</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span> <span class="c1"># update</span>
<span class="c1">##writearray(head)</span>
<span class="c1">##print(&quot;----&quot;)</span>
<span class="c1">##writearray(headold)</span>
<span class="c1">##print(&quot;--------&quot;)</span>
<span class="n">tolflag</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">for</span> <span class="nb">iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxiter</span><span class="p">):</span>
<span class="c1">##    print(&quot;begin iteration&quot;)</span>
<span class="c1">##    writearray(head)</span>
<span class="c1">##    print(&quot;----&quot;)</span>
<span class="c1">##    writearray(headold)</span>
<span class="c1">##    print(&quot;--------&quot;)</span>
<span class="c1"># first and last row special == no flow boundaries</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="n">head</span> <span class="p">[</span><span class="mi">0</span>    <span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
        <span class="n">head</span> <span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
<span class="c1"># interior updates</span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="p">(</span> <span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                              <span class="o">+</span><span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                              <span class="o">+</span><span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
                              <span class="o">+</span><span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">amat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">bmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">cmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">dmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">])</span>
<span class="c1"># test for stopping iterations</span>
<span class="c1">##    print(&quot;end iteration&quot;)</span>
<span class="c1">##    writearray(head)</span>
<span class="c1">##    print(&quot;----&quot;)</span>
<span class="c1">##    writearray(headold)</span>
    <span class="n">percentdiff</span> <span class="o">=</span> <span class="n">sse</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span>
    <span class="k">if</span>  <span class="n">percentdiff</span> <span class="o">&lt;=</span> <span class="n">tolerance</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exit iterations in velocity potential because tolerance met &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations =&quot;</span> <span class="p">,</span> <span class="nb">iter</span><span class="o">+</span><span class="mi">1</span> <span class="p">)</span> <span class="p">;</span>
        <span class="n">tolflag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">break</span>
    <span class="n">headold</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;End Calculations&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations    = &quot;</span><span class="p">,</span><span class="nb">iter</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Closure Error = &quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">percentdiff</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Head Map&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
<span class="n">writearray</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exit iterations in velocity potential because tolerance met 
Iterations = 7972
End Calculations
Iterations    =  7972
Closure Error =  0.0
Head Map
----
0 [100.     99.758  99.513  99.259  98.995  98.715  98.417  98.098  97.755
  97.383  96.9    96.329  95.729  95.167  94.674  94.159  93.617  93.053
  92.468  91.866  91.252  90.628  90.   ]
1 [100.     99.758  99.513  99.259  98.994  98.715  98.416  98.097  97.755
  97.383  96.9    96.329  95.728  95.167  94.674  94.158  93.617  93.053
  92.468  91.866  91.252  90.628  90.   ]
2 [100.     99.758  99.513  99.259  98.994  98.714  98.416  98.097  97.754
  97.383  96.9    96.329  95.727  95.166  94.674  94.158  93.617  93.052
  92.468  91.866  91.251  90.628  90.   ]
3 [100.     99.758  99.513  99.259  98.994  98.714  98.416  98.097  97.754
  97.385  96.901  96.329  95.726  95.164  94.674  94.158  93.617  93.052
  92.468  91.866  91.251  90.628  90.   ]
4 [100.     99.758  99.513  99.259  98.994  98.714  98.416  98.097  97.754
  97.387  96.903  96.328  95.724  95.161  94.673  94.158  93.617  93.052
  92.467  91.866  91.251  90.628  90.   ]
5 [100.     99.758  99.512  99.259  98.994  98.714  98.416  98.097  97.754
  97.39   96.908  96.328  95.718  95.156  94.673  94.158  93.616  93.052
  92.467  91.866  91.251  90.628  90.   ]
6 [100.     99.758  99.512  99.259  98.994  98.714  98.416  98.097  97.754
  97.392  97.39   96.328  95.156  95.154  94.673  94.157  93.616  93.052
  92.467  91.866  91.251  90.628  90.   ]
7 [100.     99.758  99.512  99.259  98.994  98.714  98.416  98.097  97.754
  97.39   96.908  96.328  95.718  95.156  94.673  94.157  93.616  93.052
  92.467  91.866  91.251  90.628  90.   ]
8 [100.     99.758  99.512  99.259  98.994  98.714  98.416  98.096  97.754
  97.386  96.903  96.328  95.723  95.16   94.673  94.157  93.616  93.052
  92.467  91.866  91.251  90.628  90.   ]
9 [100.     99.758  99.512  99.259  98.994  98.714  98.416  98.096  97.754
  97.384  96.901  96.328  95.725  95.163  94.673  94.157  93.616  93.052
  92.467  91.866  91.251  90.628  90.   ]
10 [100.     99.758  99.512  99.259  98.994  98.714  98.416  98.096  97.753
  97.382  96.899  96.328  95.726  95.165  94.673  94.157  93.616  93.052
  92.467  91.866  91.251  90.628  90.   ]
11 [100.     99.758  99.512  99.259  98.994  98.714  98.416  98.096  97.753
  97.381  96.899  96.328  95.727  95.166  94.673  94.157  93.616  93.052
  92.467  91.866  91.251  90.628  90.   ]
12 [100.     99.758  99.512  99.259  98.994  98.714  98.416  98.097  97.754
  97.382  96.899  96.328  95.727  95.166  94.673  94.157  93.616  93.052
  92.467  91.866  91.251  90.628  90.   ]
----
</pre></div>
</div>
</div>
</div>
<p>Now when you run the script, it seems to take a long time and many iterations. This
observation is indeed correct – the ratio of conductivity terms and spatial discretiza-
tion exerts a lot of influence on how fast the script can find a solution. This problem
exists for most iterative methods. One could use linear solver packages,
and simply solve the linear system without regard to structure, but assembly of the system matrix is non-trivial.  The head “array” would need to be addressed as a vector (we can use pointers to accomplish this task — not too hard, but we would need to build the coefficient matrix, solve the system, and de-construct the result).</p>
</div>
</div>
<div class="section" id="generalizing-the-boundary-conditions">
<h2>Generalizing the Boundary Conditions<a class="headerlink" href="#generalizing-the-boundary-conditions" title="Permalink to this headline">¶</a></h2>
<p>In the prior examples the boundary conditions for the problems were kind of glossed
over. We applied a fixed head boundary on the left and right edges of the rectangular
domain, and zero-flux boundary at the top and bottom edges. A useful improvement
is to allow the user to choose which type by supplying information in the input file. I
find the easiest way (as we are just learning) is to assume the entire model is always
surrounded by a constant head condition and use a mask to tell the program when
that is not true.</p>
<p>The code fragments for making this change are pretty straightforward, and are dis-
played in the listing below. We need to read in boundary indicators for the top, bottom,
left, and right boundaries. Then convert them into numeric values for later. Here I
choose to use a zero to indicate a zero-flux boundary and any non-zero (usually a 1)
to indicate a fixed head boundary.</p>
<p>Next we apply the conditions within the solver loop by assigning the compued value
of the adjacent cell (either above, below, left, or right as appropriate). The remainder
of the script is unchanged, of course we need to include the new input values in the
data file - I chose to insert the boundary mask just before the head array read.</p>
<p><strong>input2GB</strong> contents</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>
<span class="mi">10</span>
<span class="mi">1</span>
<span class="mi">13</span>
<span class="mi">23</span>
<span class="mf">1e-5</span> 
<span class="mi">9000</span>
<span class="mi">5</span> <span class="mi">15</span> <span class="mi">25</span> <span class="mi">35</span> <span class="mi">45</span> <span class="mi">55</span> <span class="mi">65</span> <span class="mi">75</span> <span class="mi">85</span> <span class="mi">95</span> <span class="mi">105</span> <span class="mi">115</span> <span class="mi">125</span> <span class="mi">135</span> <span class="mi">145</span> <span class="mi">155</span> <span class="mi">165</span> <span class="mi">175</span> <span class="mi">185</span> <span class="mi">195</span> <span class="mi">205</span> <span class="mi">215</span> <span class="mi">225</span>
<span class="mf">0.5</span> <span class="mf">1.5</span> <span class="mf">2.5</span> <span class="mf">3.5</span> <span class="mf">4.5</span> <span class="mf">5.5</span> <span class="mf">6.5</span> <span class="mf">7.5</span> <span class="mf">8.5</span> <span class="mf">9.5</span> <span class="mf">10.5</span> <span class="mf">11.5</span> <span class="mf">12.5</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> 
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> 
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> 
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> 
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">90</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">90</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">90</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">90</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">90</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">90</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">90</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">90</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">90</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">90</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">90</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">90</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">90</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sse</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">sse</span><span class="o">=</span><span class="mf">0.0</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">sse</span><span class="o">=</span><span class="n">sse</span><span class="o">+</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">-</span><span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span><span class="p">(</span><span class="n">sse</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="c1">##print(nr,nc)</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="c1">##print(ir,jc)</span>
            <span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">=</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span>
    <span class="k">return</span><span class="p">(</span><span class="n">matrix2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">writearray</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="n">new_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>    
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">new_list</span><span class="p">[</span><span class="n">ir</span><span class="p">][:])</span>
    <span class="k">return</span><span class="p">()</span>

<span class="n">localfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;input2GB.txt&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="c1"># connect and read file for 2D gw model</span>
<span class="n">deltax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltay</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltaz</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">tolerance</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">maxiter</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">distancex</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancex</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">distancey</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancey</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarytop</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarytop</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarybottom</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarybottom</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryleft</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryleft</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryright</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryright</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">head</span> <span class="o">=</span><span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">head</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">hydcondx</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondx</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">hydcondy</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondy</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">localfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="c1"># Disconnect the file</span>
<span class="c1">##</span>
<span class="n">amat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">bmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">cmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">dmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="c1">##</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">##</span>
<span class="n">headold</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span> <span class="c1">#force new matrix</span>
<span class="n">headold</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span> <span class="c1"># update</span>
<span class="c1">##writearray(head)</span>
<span class="c1">##print(&quot;----&quot;)</span>
<span class="c1">##writearray(headold)</span>
<span class="c1">##print(&quot;--------&quot;)</span>
<span class="n">tolflag</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">for</span> <span class="nb">iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxiter</span><span class="p">):</span>
<span class="c1">##    print(&quot;begin iteration&quot;)</span>
<span class="c1">##    writearray(head)</span>
<span class="c1">##    print(&quot;----&quot;)</span>
<span class="c1">##    writearray(headold)</span>
<span class="c1">##    print(&quot;--------&quot;)</span>

<span class="c1"># Boundary Conditions</span>

<span class="c1"># first and last row special == no flow boundaries</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">boundarytop</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at top</span>
            <span class="n">head</span> <span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
        <span class="k">if</span> <span class="n">boundarybottom</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">jcol</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at bottom</span>
            <span class="n">head</span> <span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
<span class="c1"># first and last column special == no flow boundaries     </span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span> 
        <span class="k">if</span>  <span class="n">boundaryleft</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># no - flow at left</span>
        <span class="k">if</span> <span class="n">boundaryright</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
            <span class="n">head</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span> <span class="n">irow</span> <span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># no - flow at right</span>
<span class="c1"># interior updates</span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="p">(</span> <span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                              <span class="o">+</span><span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                              <span class="o">+</span><span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
                              <span class="o">+</span><span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">amat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">bmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">cmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">dmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">])</span>
<span class="c1"># test for stopping iterations</span>
<span class="c1">##    print(&quot;end iteration&quot;)</span>
<span class="c1">##    writearray(head)</span>
<span class="c1">##    print(&quot;----&quot;)</span>
<span class="c1">##    writearray(headold)</span>
    <span class="n">percentdiff</span> <span class="o">=</span> <span class="n">sse</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span>
    <span class="k">if</span>  <span class="n">percentdiff</span> <span class="o">&lt;=</span> <span class="n">tolerance</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exit iterations in velocity potential because tolerance met &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations =&quot;</span> <span class="p">,</span> <span class="nb">iter</span><span class="o">+</span><span class="mi">1</span> <span class="p">)</span> <span class="p">;</span>
        <span class="n">tolflag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">break</span>
    <span class="n">headold</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;End Calculations&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations    = &quot;</span><span class="p">,</span><span class="nb">iter</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Closure Error = &quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">percentdiff</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Head Map&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
<span class="n">writearray</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exit iterations in velocity potential because tolerance met 
Iterations = 7972
End Calculations
Iterations    =  7972
Closure Error =  0.0
Head Map
----
0 [100.     99.758  99.513  99.259  98.995  98.715  98.417  98.098  97.755
  97.383  96.9    96.329  95.729  95.167  94.674  94.159  93.617  93.053
  92.468  91.866  91.252  90.628  90.   ]
1 [100.     99.758  99.513  99.259  98.994  98.715  98.416  98.097  97.755
  97.383  96.9    96.329  95.728  95.167  94.674  94.158  93.617  93.053
  92.468  91.866  91.252  90.628  90.   ]
2 [100.     99.758  99.513  99.259  98.994  98.714  98.416  98.097  97.754
  97.383  96.9    96.329  95.727  95.166  94.674  94.158  93.617  93.052
  92.468  91.866  91.251  90.628  90.   ]
3 [100.     99.758  99.513  99.259  98.994  98.714  98.416  98.097  97.754
  97.385  96.901  96.329  95.726  95.164  94.674  94.158  93.617  93.052
  92.468  91.866  91.251  90.628  90.   ]
4 [100.     99.758  99.513  99.259  98.994  98.714  98.416  98.097  97.754
  97.387  96.903  96.328  95.724  95.161  94.673  94.158  93.617  93.052
  92.467  91.866  91.251  90.628  90.   ]
5 [100.     99.758  99.512  99.259  98.994  98.714  98.416  98.097  97.754
  97.39   96.908  96.328  95.718  95.156  94.673  94.158  93.616  93.052
  92.467  91.866  91.251  90.628  90.   ]
6 [100.     99.758  99.512  99.259  98.994  98.714  98.416  98.097  97.754
  97.392  97.39   96.328  95.156  95.154  94.673  94.157  93.616  93.052
  92.467  91.866  91.251  90.628  90.   ]
7 [100.     99.758  99.512  99.259  98.994  98.714  98.416  98.097  97.754
  97.39   96.908  96.328  95.718  95.156  94.673  94.157  93.616  93.052
  92.467  91.866  91.251  90.628  90.   ]
8 [100.     99.758  99.512  99.259  98.994  98.714  98.416  98.096  97.754
  97.386  96.903  96.328  95.723  95.16   94.673  94.157  93.616  93.052
  92.467  91.866  91.251  90.628  90.   ]
9 [100.     99.758  99.512  99.259  98.994  98.714  98.416  98.096  97.754
  97.384  96.901  96.328  95.725  95.163  94.673  94.157  93.616  93.052
  92.467  91.866  91.251  90.628  90.   ]
10 [100.     99.758  99.512  99.259  98.994  98.714  98.416  98.096  97.753
  97.382  96.899  96.328  95.726  95.165  94.673  94.157  93.616  93.052
  92.467  91.866  91.251  90.628  90.   ]
11 [100.     99.758  99.512  99.259  98.994  98.714  98.416  98.096  97.753
  97.381  96.899  96.328  95.727  95.166  94.673  94.157  93.616  93.052
  92.467  91.866  91.251  90.628  90.   ]
12 [100.     99.758  99.512  99.259  98.994  98.714  98.416  98.097  97.754
  97.382  96.899  96.328  95.727  95.166  94.673  94.157  93.616  93.052
  92.467  91.866  91.251  90.628  90.   ]
----
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="contour-plotting">
<h2>Contour Plotting<a class="headerlink" href="#contour-plotting" title="Permalink to this headline">¶</a></h2>
<p>This is really a separate topic, but its a useful way to view output, so we will just append some code here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://clouds.eos.ubc.ca/~phil/docs/problem_solving/06-Plotting-with-Matplotlib/06.14-Contour-Plots.html</span>
<span class="c1"># https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.griddata.html</span>
<span class="c1"># https://stackoverflow.com/questions/332289/how-do-you-change-the-size-of-figures-drawn-with-matplotlib</span>
<span class="c1"># https://stackoverflow.com/questions/18730044/converting-two-lists-into-a-matrix</span>
<span class="c1"># https://stackoverflow.com/questions/3242382/interpolation-over-an-irregular-grid</span>
<span class="c1"># https://stackoverflow.com/questions/33919875/interpolate-irregular-3d-data-from-a-xyz-file-to-a-regular-grid</span>
<span class="c1"># build XYZ structure from head map</span>
<span class="n">my_xyz</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="n">my_xyz</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">distancex</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">],</span><span class="n">distancey</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">irow</span><span class="p">],</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span>
<span class="n">my_xyz</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">my_xyz</span><span class="p">)</span> <span class="c1"># convert into a data frame</span>
<span class="c1">#print(my_xyz) # activate to examine the dataframe</span>
<span class="kn">import</span> <span class="nn">numpy</span> 
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>
<span class="c1"># extract lists from the dataframe</span>
<span class="n">coord_x</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 0 of dataframe</span>
<span class="n">coord_y</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 1 of dataframe</span>
<span class="n">coord_z</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 2 of dataframe</span>
<span class="n">coord_xy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">coord_x</span><span class="p">,</span> <span class="n">coord_y</span><span class="p">))</span>
<span class="c1"># Set plotting range in original data units</span>
<span class="n">lon</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="mi">45</span><span class="p">)</span>
<span class="n">lat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="mi">21</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
<span class="c1"># Grid the data; use linear interpolation (choices are nearest, linear, cubic)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_xy</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_z</span><span class="p">),</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="c1"># Build the map</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Contour Plot from Gridded Data File&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Contour Plot from Gridded Data File&#39;)
</pre></div>
</div>
<img alt="../../_images/13gwmodels_14_1.png" src="../../_images/13gwmodels_14_1.png" />
</div>
</div>
<p>Addition of the generalized boundary conditions, and contour plotting expands the utility of our script as illustrated in the next example.</p>
<div class="section" id="homebrew-example-3-pore-pressure-under-a-dam">
<h3>Homebrew - Example 3: Pore Pressure under a Dam<a class="headerlink" href="#homebrew-example-3-pore-pressure-under-a-dam" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="#sheetpile1"><span class="std std-numref">Fig. 22</span></a> is a schematic of a dam built upon a permeable ground layer 80 meters thick (segment A to I).</p>
<div class="figure align-default" id="sheetpile1">
<a class="reference internal image-reference" href="../../_images/sheetpile1.png"><img alt="../../_images/sheetpile1.png" src="../../_images/sheetpile1.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 22 </span><span class="caption-text">Schematic of a dam on permeable soil with the sheet pile curtain underneath the dam.</span><a class="headerlink" href="#sheetpile1" title="Permalink to this image">¶</a></p>
</div>
<p>The dam has a base 60 meters wide (segment B to F), with an upstream water depth of 10 meters. The downstream side of the dam is at 0 meters depth (otherwise its not a very good dam!). A sheetpile cutoff wall is installed beneath the dam (segment C to D to U to E). The ground layer has a hydraulic conductivity of K = 1 × 10−4 meters per second.</p>
<p>Important engineering questions are what is the pore water pressure under the dam, and is what is the total seepage under the dam? The pore water pressure can be found by solving for heads under the dam then subtracting the elevation of the computation location relative to a datum. The flow is found by Darcy’s law applied under the dam (shown as locations 1,2,3,4, and 5 in the sketch), which in turn requires computation of head under the dam. Thus the questions are answered by finding the head distribution under the dam.</p>
<p>The flow field (mathematically) extends an infinite distance upstream and downstream, but as a practical matter the contribution to seepage far upstream of the dam is negligible, and hence is approximated by the finite domain depicted.</p>
<p>Using the tools we have already built we can simply build an input file, run our
script and determine the head distribution (and thus compute the discharges under
the dam. There are two ways to conceptualize the model domain, we will examine both.</p>
<p>The first is to represent the domain as shown, and make the following specifications
in the boundary condition information, and we will treat the sheetpile cutoff wall
as a low permeability inclusion (much like the the prior example). The boundary
conditions are:</p>
<ol class="simple">
<li><p>The segment from A to B is a constant head boundary with value equal to 10.</p></li>
<li><p>The segment from B to F is a zero-flux boundary.</p></li>
<li><p>The segment from B to C to D to U to E to F should be treated as a zero-flux boundary, but our mask does not extend into the interior – however the sheetpile itself can be approximated by providing a very small permeability. Alternately we could (should) modify the code to handle interior boundaries – but that is outside the scope of this chapter.</p></li>
<li><p>The segment from F to G is a constant head boundary with value equal to 0.</p></li>
<li><p>The segment form G to H is a constant head boundary with value equal to 0.</p></li>
<li><p>The segment from H to I is a zero-flux boundary.</p></li>
<li><p>The segment from I to A is a constant head boundary with value equal to 10.</p></li>
</ol>
<p><strong>input3.txt</strong> contents</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">10</span>
<span class="mi">10</span>
<span class="mi">1</span>
<span class="mi">9</span>
<span class="mi">31</span>
<span class="mf">1e-12</span>
<span class="mi">5000</span>
<span class="mi">0</span> <span class="mi">10</span> <span class="mi">20</span> <span class="mi">30</span> <span class="mi">40</span> <span class="mi">50</span> <span class="mi">60</span> <span class="mi">70</span> <span class="mi">80</span> <span class="mi">90</span> <span class="mi">100</span> <span class="mi">110</span> <span class="mi">120</span> <span class="mi">130</span> <span class="mi">140</span> <span class="mi">150</span> <span class="mi">160</span> <span class="mi">170</span> <span class="mi">180</span> <span class="mi">190</span> <span class="mi">200</span> <span class="mi">210</span> <span class="mi">220</span> <span class="mi">230</span> <span class="mi">240</span> <span class="mi">250</span> <span class="mi">260</span> <span class="mi">270</span> <span class="mi">280</span> <span class="mi">290</span> <span class="mi">300</span>
<span class="mi">80</span> <span class="mi">70</span> <span class="mi">60</span> <span class="mi">50</span> <span class="mi">40</span> <span class="mi">30</span> <span class="mi">20</span> <span class="mi">10</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.00010</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.00010</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sse</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">sse</span><span class="o">=</span><span class="mf">0.0</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">sse</span><span class="o">=</span><span class="n">sse</span><span class="o">+</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">-</span><span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span><span class="p">(</span><span class="n">sse</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="c1">##print(nr,nc)</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="c1">##print(ir,jc)</span>
            <span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">=</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span>
    <span class="k">return</span><span class="p">(</span><span class="n">matrix2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">writearray</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="n">new_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>    
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">new_list</span><span class="p">[</span><span class="n">ir</span><span class="p">][:])</span>
    <span class="k">return</span><span class="p">()</span>

<span class="n">localfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;input3.txt&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="c1"># connect and read file for 2D gw model</span>
<span class="n">deltax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltay</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltaz</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">tolerance</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">maxiter</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">distancex</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancex</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">distancey</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancey</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarytop</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarytop</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarybottom</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarybottom</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryleft</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryleft</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryright</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryright</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">head</span> <span class="o">=</span><span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">head</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">hydcondx</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondx</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">hydcondy</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondy</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">localfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="c1"># Disconnect the file</span>
<span class="c1">##</span>
<span class="n">amat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">bmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">cmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">dmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="c1">##</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">##</span>
<span class="n">headold</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span> <span class="c1">#force new matrix</span>
<span class="n">headold</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span> <span class="c1"># update</span>
<span class="c1">##writearray(head)</span>
<span class="c1">##print(&quot;----&quot;)</span>
<span class="c1">##writearray(headold)</span>
<span class="c1">##print(&quot;--------&quot;)</span>
<span class="n">tolflag</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">for</span> <span class="nb">iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxiter</span><span class="p">):</span>
<span class="c1">##    print(&quot;begin iteration&quot;)</span>
<span class="c1">##    writearray(head)</span>
<span class="c1">##    print(&quot;----&quot;)</span>
<span class="c1">##    writearray(headold)</span>
<span class="c1">##    print(&quot;--------&quot;)</span>

<span class="c1"># Boundary Conditions</span>

<span class="c1"># first and last row special == no flow boundaries</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">boundarytop</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at top</span>
            <span class="n">head</span> <span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
        <span class="k">if</span> <span class="n">boundarybottom</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">jcol</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at bottom</span>
            <span class="n">head</span> <span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
<span class="c1"># first and last column special == no flow boundaries     </span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span> 
        <span class="k">if</span>  <span class="n">boundaryleft</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># no - flow at left</span>
        <span class="k">if</span> <span class="n">boundaryright</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
            <span class="n">head</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span> <span class="n">irow</span> <span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># no - flow at right</span>
<span class="c1"># interior updates</span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="p">(</span> <span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                              <span class="o">+</span><span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                              <span class="o">+</span><span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
                              <span class="o">+</span><span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">amat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">bmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">cmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">dmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">])</span>
<span class="c1"># test for stopping iterations</span>
<span class="c1">##    print(&quot;end iteration&quot;)</span>
<span class="c1">##    writearray(head)</span>
<span class="c1">##    print(&quot;----&quot;)</span>
<span class="c1">##    writearray(headold)</span>
    <span class="n">percentdiff</span> <span class="o">=</span> <span class="n">sse</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span>
    <span class="k">if</span>  <span class="n">percentdiff</span> <span class="o">&lt;=</span> <span class="n">tolerance</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exit iterations in velocity potential because tolerance met &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations =&quot;</span> <span class="p">,</span> <span class="nb">iter</span><span class="o">+</span><span class="mi">1</span> <span class="p">)</span> <span class="p">;</span>
        <span class="n">tolflag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">break</span>
    <span class="n">headold</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;End Calculations&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations    = &quot;</span><span class="p">,</span><span class="nb">iter</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Closure Error = &quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">percentdiff</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Head Map&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
<span class="n">writearray</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exit iterations in velocity potential because tolerance met 
Iterations = 519
End Calculations
Iterations    =  519
Closure Error =  0.0
Head Map
----
0 [10.    10.    10.    10.    10.    10.    10.    10.    10.    10.
 10.    10.     8.819  8.595  8.593  1.414  1.412  1.187  0.     0.
  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  0.   ]
1 [10.     9.977  9.954  9.928  9.899  9.866  9.826  9.777  9.715  9.633
  9.512  9.3    8.819  8.595  8.593  1.414  1.412  1.187  0.705  0.492
  0.371  0.289  0.228  0.18   0.141  0.109  0.082  0.058  0.037  0.018
  0.   ]
2 [10.     9.956  9.91   9.86   9.803  9.738  9.661  9.567  9.451  9.305
  9.116  8.868  8.562  8.372  8.37   1.638  1.636  1.446  1.139  0.891
  0.703  0.557  0.443  0.35   0.275  0.212  0.16   0.114  0.073  0.036
  0.   ]
3 [10.     9.936  9.87   9.798  9.717  9.623  9.512  9.379  9.217  9.019
  8.778  8.493  8.189  7.959  7.957  2.051  2.05   1.82   1.515  1.231
  0.991  0.795  0.635  0.504  0.396  0.306  0.23   0.164  0.106  0.052
  0.   ]
4 [10.     9.92   9.836  9.745  9.642  9.524  9.385  9.219  9.019  8.776
  8.485  8.139  7.743  7.316  6.481  3.529  2.694  2.267  1.872  1.527
  1.236  0.996  0.798  0.635  0.5    0.387  0.291  0.208  0.134  0.065
  0.   ]
5 [10.     9.906  9.809  9.703  9.584  9.447  9.286  9.093  8.862  8.583
  8.245  7.834  7.327  6.665  5.647  4.364  3.346  2.684  2.178  1.768
  1.431  1.154  0.926  0.738  0.581  0.45   0.339  0.242  0.156  0.076
  0.   ]
6 [10.     9.897  9.79   9.674  9.543  9.393  9.217  9.007  8.754  8.449
  8.078  7.626  7.067  6.369  5.493  4.518  3.642  2.945  2.387  1.936
  1.567  1.264  1.014  0.809  0.637  0.494  0.371  0.265  0.171  0.084
  0.   ]
7 [10.     9.893  9.781  9.659  9.523  9.366  9.182  8.963  8.699  8.381
  7.994  7.522  6.947  6.252  5.439  4.572  3.76   3.065  2.491  2.021
  1.636  1.32   1.06   0.845  0.666  0.516  0.388  0.277  0.178  0.087
  0.   ]
8 [10.     9.893  9.781  9.659  9.523  9.366  9.182  8.963  8.699  8.381
  7.994  7.522  6.947  6.252  5.439  4.572  3.76   3.065  2.491  2.021
  1.636  1.32   1.06   0.845  0.666  0.516  0.388  0.277  0.178  0.087
  0.   ]
----
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://clouds.eos.ubc.ca/~phil/docs/problem_solving/06-Plotting-with-Matplotlib/06.14-Contour-Plots.html</span>
<span class="c1"># https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.griddata.html</span>
<span class="c1"># https://stackoverflow.com/questions/332289/how-do-you-change-the-size-of-figures-drawn-with-matplotlib</span>
<span class="c1"># https://stackoverflow.com/questions/18730044/converting-two-lists-into-a-matrix</span>
<span class="c1"># https://stackoverflow.com/questions/3242382/interpolation-over-an-irregular-grid</span>
<span class="c1"># https://stackoverflow.com/questions/33919875/interpolate-irregular-3d-data-from-a-xyz-file-to-a-regular-grid</span>
<span class="c1"># build XYZ structure from head map</span>
<span class="n">my_xyz</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="n">my_xyz</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">distancex</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">],</span><span class="n">distancey</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">irow</span><span class="p">],</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]])</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="n">my_xyz</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">my_xyz</span><span class="p">)</span> <span class="c1"># convert into a data frame</span>
<span class="c1">#print(my_xyz) # activate to examine the dataframe</span>
<span class="kn">import</span> <span class="nn">numpy</span> 
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>
<span class="c1"># extract lists from the dataframe</span>
<span class="n">coord_x</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 0 of dataframe</span>
<span class="n">coord_y</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 1 of dataframe</span>
<span class="n">coord_z</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 2 of dataframe</span>
<span class="n">coord_xy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">coord_x</span><span class="p">,</span> <span class="n">coord_y</span><span class="p">))</span>
<span class="c1"># Set plotting range in original data units</span>
<span class="n">lon</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">lat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="mi">80</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
<span class="c1"># Grid the data; use linear interpolation (choices are nearest, linear, cubic)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_xy</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_z</span><span class="p">),</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="c1"># Build the map</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Contour Plot from Gridded Data File&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Contour Plot from Gridded Data File&#39;)
</pre></div>
</div>
<img alt="../../_images/13gwmodels_17_1.png" src="../../_images/13gwmodels_17_1.png" />
</div>
</div>
<p>If we apply Darcy’s law to the portion in the vertical direction (where flow
must be vertical to seep under the dam) the result is about <span class="math notranslate nohighlight">\(3.76 m^3\)</span> per day, per
meter of width.</p>
<p>This example (like most roll-your-own) requires some specific knowledge of hydraulics
to interpret the results, in this case knowing to apply Darcy’s law along the bottom
of the reservoir to determine the flow rate, and to integrate (sum up) the individual
cell flows to obtain total flow.</p>
</div>
<div class="section" id="homebrew-example-4-pore-pressure-under-a-dam-domain-decomposition-approach">
<h3>Homebrew - Example 4 : Pore Pressure under a Dam (Domain Decomposition approach)<a class="headerlink" href="#homebrew-example-4-pore-pressure-under-a-dam-domain-decomposition-approach" title="Permalink to this headline">¶</a></h3>
<p>The second way to solve this example, and perhaps better is to take advantage of
the symmetry and cut the domain in half, as in <a class="reference internal" href="#sheetpile2"><span class="std std-numref">Fig. 23</span></a>.</p>
<div class="figure align-default" id="sheetpile2">
<a class="reference internal image-reference" href="../../_images/sheetpile2.png"><img alt="../../_images/sheetpile2.png" src="../../_images/sheetpile2.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 23 </span><span class="caption-text">Schematic of a dam on permeable soil with the sheet pile curtain underneath the dam.</span><a class="headerlink" href="#sheetpile2" title="Permalink to this image">¶</a></p>
</div>
<p>In this method we can actually specify the sheetpile as a boundary, and we will obtain the same results, but
only need to supply half as much input data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sse</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">sse</span><span class="o">=</span><span class="mf">0.0</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">sse</span><span class="o">=</span><span class="n">sse</span><span class="o">+</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">-</span><span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span><span class="p">(</span><span class="n">sse</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="c1">##print(nr,nc)</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="c1">##print(ir,jc)</span>
            <span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">=</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span>
    <span class="k">return</span><span class="p">(</span><span class="n">matrix2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">writearray</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="n">new_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>    
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">new_list</span><span class="p">[</span><span class="n">ir</span><span class="p">][:])</span>
    <span class="k">return</span><span class="p">()</span>

<span class="n">localfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;input4.txt&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="c1"># connect and read file for 2D gw model</span>
<span class="n">deltax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltay</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltaz</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">tolerance</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">maxiter</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">distancex</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancex</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">distancey</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancey</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarytop</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarytop</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarybottom</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarybottom</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryleft</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryleft</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryright</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryright</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">head</span> <span class="o">=</span><span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">head</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">hydcondx</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondx</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">hydcondy</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondy</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">localfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="c1"># Disconnect the file</span>
<span class="c1">##</span>
<span class="n">amat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">bmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">cmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">dmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="c1">##</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">##</span>
<span class="n">headold</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span> <span class="c1">#force new matrix</span>
<span class="n">headold</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span> <span class="c1"># update</span>
<span class="c1">##writearray(head)</span>
<span class="c1">##print(&quot;----&quot;)</span>
<span class="c1">##writearray(headold)</span>
<span class="c1">##print(&quot;--------&quot;)</span>
<span class="n">tolflag</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">for</span> <span class="nb">iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxiter</span><span class="p">):</span>
<span class="c1">##    print(&quot;begin iteration&quot;)</span>
<span class="c1">##    writearray(head)</span>
<span class="c1">##    print(&quot;----&quot;)</span>
<span class="c1">##    writearray(headold)</span>
<span class="c1">##    print(&quot;--------&quot;)</span>

<span class="c1"># Boundary Conditions</span>

<span class="c1"># first and last row special == no flow boundaries</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">boundarytop</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at top</span>
            <span class="n">head</span> <span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
        <span class="k">if</span> <span class="n">boundarybottom</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">jcol</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at bottom</span>
            <span class="n">head</span> <span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
<span class="c1"># first and last column special == no flow boundaries     </span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span> 
        <span class="k">if</span>  <span class="n">boundaryleft</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># no - flow at left</span>
        <span class="k">if</span> <span class="n">boundaryright</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
            <span class="n">head</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span> <span class="n">irow</span> <span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># no - flow at right</span>
<span class="c1"># interior updates</span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="p">(</span> <span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                              <span class="o">+</span><span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                              <span class="o">+</span><span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
                              <span class="o">+</span><span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">amat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">bmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">cmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">dmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">])</span>
<span class="c1"># test for stopping iterations</span>
<span class="c1">##    print(&quot;end iteration&quot;)</span>
<span class="c1">##    writearray(head)</span>
<span class="c1">##    print(&quot;----&quot;)</span>
<span class="c1">##    writearray(headold)</span>
    <span class="n">percentdiff</span> <span class="o">=</span> <span class="n">sse</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span>
    <span class="k">if</span>  <span class="n">percentdiff</span> <span class="o">&lt;=</span> <span class="n">tolerance</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exit iterations in velocity potential because tolerance met &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations =&quot;</span> <span class="p">,</span> <span class="nb">iter</span><span class="o">+</span><span class="mi">1</span> <span class="p">)</span> <span class="p">;</span>
        <span class="n">tolflag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">break</span>
    <span class="n">headold</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;End Calculations&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations    = &quot;</span><span class="p">,</span><span class="nb">iter</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Closure Error = &quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">percentdiff</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Head Map&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
<span class="n">writearray</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exit iterations in velocity potential because tolerance met 
Iterations = 412
End Calculations
Iterations    =  412
Closure Error =  0.0
Head Map
----
0 [10. 10. 10. 10. 10. 10. 10. 10. 10. 10. 10. 10. 10. 10. 10.]
1 [10.     9.975  9.949  9.921  9.889  9.853  9.811  9.761  9.701  9.632
  9.552  9.466  9.384  9.329  9.329]
2 [10.     9.951  9.9    9.845  9.783  9.712  9.629  9.531  9.413  9.274
  9.111  8.928  8.742  8.602  8.602]
3 [10.     9.93   9.856  9.776  9.687  9.584  9.463  9.319  9.147  8.939
  8.69   8.393  8.056  7.734  7.734]
4 [10.     9.911  9.818  9.717  9.604  9.473  9.32   9.137  8.916  8.647
  8.316  7.9    7.353  6.544  5.   ]
5 [10.     9.896  9.788  9.67   9.538  9.385  9.206  8.992  8.733  8.416
  8.026  7.538  6.913  6.088  5.   ]
6 [10.     9.886  9.767  9.637  9.492  9.325  9.127  8.891  8.607  8.26
  7.835  7.313  6.672  5.895  5.   ]
7 [10.     9.881  9.756  9.621  9.469  9.293  9.087  8.84   8.543  8.181
  7.741  7.207  6.566  5.82   5.   ]
8 [10.     9.881  9.756  9.621  9.469  9.293  9.087  8.84   8.543  8.181
  7.741  7.207  6.566  5.82   5.   ]
----
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://clouds.eos.ubc.ca/~phil/docs/problem_solving/06-Plotting-with-Matplotlib/06.14-Contour-Plots.html</span>
<span class="c1"># https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.griddata.html</span>
<span class="c1"># https://stackoverflow.com/questions/332289/how-do-you-change-the-size-of-figures-drawn-with-matplotlib</span>
<span class="c1"># https://stackoverflow.com/questions/18730044/converting-two-lists-into-a-matrix</span>
<span class="c1"># https://stackoverflow.com/questions/3242382/interpolation-over-an-irregular-grid</span>
<span class="c1"># https://stackoverflow.com/questions/33919875/interpolate-irregular-3d-data-from-a-xyz-file-to-a-regular-grid</span>
<span class="c1"># build XYZ structure from head map</span>
<span class="n">my_xyz</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="n">my_xyz</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">distancex</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">],</span><span class="n">distancey</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">irow</span><span class="p">],</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]])</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="n">my_xyz</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">my_xyz</span><span class="p">)</span> <span class="c1"># convert into a data frame</span>
<span class="c1">#print(my_xyz) # activate to examine the dataframe</span>
<span class="kn">import</span> <span class="nn">numpy</span> 
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>
<span class="c1"># extract lists from the dataframe</span>
<span class="n">coord_x</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 0 of dataframe</span>
<span class="n">coord_y</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 1 of dataframe</span>
<span class="n">coord_z</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 2 of dataframe</span>
<span class="n">coord_xy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">coord_x</span><span class="p">,</span> <span class="n">coord_y</span><span class="p">))</span>
<span class="c1"># Set plotting range in original data units</span>
<span class="n">lon</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">lat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="mi">80</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
<span class="c1"># Grid the data; use linear interpolation (choices are nearest, linear, cubic)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_xy</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_z</span><span class="p">),</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="c1"># Build the map</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Contour Plot from Gridded Data File&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Contour Plot from Gridded Data File&#39;)
</pre></div>
</div>
<img alt="../../_images/13gwmodels_20_1.png" src="../../_images/13gwmodels_20_1.png" />
</div>
</div>
<p>If we repeat the flow calculations, this time along the portion at the bottom of the sheetpile, we obtain nearly the same result, <span class="math notranslate nohighlight">\(3.74 m^3\)</span> per day, per meter of width.</p>
<p>This second way of solving the problem is far more correct because we didn’t have to choose
an artificial value to mimic the effect of the sheetpile</p>
<p>The next concept is to illustrate a means to approximate the effect of a
localized source (recharge or an injection well) or sink (pumping well). To incorporate
these kinds of inputs we add terms to the governing equation as</p>
<div class="math notranslate nohighlight">
\[
S \frac{\partial h}{\partial t} = 
\frac{\partial}{\partial x}({T_x \frac{\partial h}{\partial x}}) +
\frac{\partial}{\partial y}({T_y \frac{\partial h}{\partial y}}) + R - Q
\]</div>
<p>where R and Q are recharge and pumping expressed in dimensions of <span class="math notranslate nohighlight">\(\frac{L^3}{T}\)</span>.</p>
<p>The resulting difference equation is</p>
<div class="math notranslate nohighlight">
\[ S \frac{\partial h_{i,j}}{\partial t} = [ \frac{1}{\Delta x} T_x \frac{h_{i−1,j} − h_{i,j}}{\Delta x} + \frac{1}{\Delta y} T_y \frac{h_{i,j-1} − h_{i,j}}{\Delta y}]-[\frac{1}{\Delta x} T_x \frac{h_{i,j} − h_{i+1,j}}{\Delta x} + \frac{1}{\Delta y} T_y \frac{h_{i,j} − h_{i,j+1}}{\Delta y}] + \frac{R_{i,j}}{\Delta x \Delta y} - \frac{Q_{i,j}}{\Delta x \Delta y}\]</div>
<p>At equilibrium the time derivative vanishes and we have</p>
<div class="math notranslate nohighlight">
\[ 0 = [ \frac{1}{\Delta x} T_x \frac{h_{i−1,j} − h_{i,j}}{\Delta x} + \frac{1}{\Delta y} T_y \frac{h_{i,j-1} − h_{i,j}}{\Delta y}]-[\frac{1}{\Delta x} T_x \frac{h_{i,j} − h_{i+1,j}}{\Delta x} + \frac{1}{\Delta y} T_y \frac{h_{i,j} − h_{i,j+1}}{\Delta y}] + \frac{R_{i,j}}{\Delta x \Delta y} - \frac{Q_{i,j}}{\Delta x \Delta y}\]</div>
<p>These additions are incorporated into our program by only adding a few code fragments in certain places. The next listing shows the various added components to handle a well field. Observe we can incorporate recharge as if it were a well with a negative pumping rate so for this document it is not considered separately, although in many
practical cases that might be a preferable way to incorporate the process.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To clarify, we are entering net pumping which is <span class="math notranslate nohighlight">\(R-Q\)</span> as a single value for each cell.</p>
</div>
</div>
<div class="section" id="homebrew-example-5-wells-in-a-rectangular-aquifer">
<h3>Homebrew - Example 5: Wells in a rectangular aquifer<a class="headerlink" href="#homebrew-example-5-wells-in-a-rectangular-aquifer" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="#wells-confined"><span class="std std-numref">Fig. 24</span></a>  is a rectangular aquifer with 4 wells as shown.</p>
<div class="figure align-default" id="wells-confined">
<a class="reference internal image-reference" href="../../_images/4wells-confined.png"><img alt="../../_images/4wells-confined.png" src="../../_images/4wells-confined.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 24 </span><span class="caption-text">Confined rectangular aquifer with 4 wells.</span><a class="headerlink" href="#wells-confined" title="Permalink to this image">¶</a></p>
</div>
<p>The aquifer thickness is 1 meters. The aquifer is surrounded with a constant head boundary of 30 meters. The hydraulic conductivity is <span class="math notranslate nohighlight">\(K = 0.033\)</span> m/day. Using a 10 meter × 10 meter grid spacing estimate the pumping rate in each well so that the head within the rectangular area defined by the well field is no smaller than 15 meters.</p>
<p>The script is modified to read an additional net pumping array just after the <span class="math notranslate nohighlight">\(K_{x,y}\)</span> terms.</p>
<p>The input file is a bit more complex because of its growing size; as the input requirements become substantial, one would write separate scripts just to build input files to structure them properly.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We are essentially constructing a specialized database, and manually building that database can become tedious whereas we can automatically populate portions of the database with a script.</p>
</div>
<p><strong>input5.txt</strong> contents</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">10</span>
<span class="mi">10</span>
<span class="mi">1</span>
<span class="mi">28</span>
<span class="mi">28</span>
<span class="mf">1e-9</span>
<span class="mi">5000</span>
<span class="mi">0</span> <span class="mi">10</span> <span class="mi">20</span> <span class="mi">30</span> <span class="mi">40</span> <span class="mi">50</span> <span class="mi">60</span> <span class="mi">70</span> <span class="mi">80</span> <span class="mi">90</span> <span class="mi">100</span> <span class="mi">110</span> <span class="mi">120</span> <span class="mi">130</span> <span class="mi">140</span> <span class="mi">150</span> <span class="mi">160</span> <span class="mi">170</span> <span class="mi">180</span> <span class="mi">190</span> <span class="mi">200</span> <span class="mi">210</span> <span class="mi">220</span> <span class="mi">230</span> <span class="mi">240</span> <span class="mi">250</span> <span class="mi">260</span> <span class="mi">270</span>
<span class="mi">0</span> <span class="mi">10</span> <span class="mi">20</span> <span class="mi">30</span> <span class="mi">40</span> <span class="mi">50</span> <span class="mi">60</span> <span class="mi">70</span> <span class="mi">80</span> <span class="mi">90</span> <span class="mi">100</span> <span class="mi">110</span> <span class="mi">120</span> <span class="mi">130</span> <span class="mi">140</span> <span class="mi">150</span> <span class="mi">160</span> <span class="mi">170</span> <span class="mi">180</span> <span class="mi">190</span> <span class="mi">200</span> <span class="mi">210</span> <span class="mi">220</span> <span class="mi">230</span> <span class="mi">240</span> <span class="mi">250</span> <span class="mi">260</span> <span class="mi">270</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span>
<span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span>
<span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span>
<span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span>
<span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span>
<span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span>
<span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span>
<span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span>
<span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span>
<span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span>
<span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span>
<span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span>
<span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span>
<span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span>
<span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span>
<span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span>
<span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span>
<span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span>
<span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span>
<span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span>
<span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span>
<span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span>
<span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span>
<span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span>
<span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span>
<span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span>
<span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span>
<span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span> <span class="mi">30</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span> <span class="mf">0.033</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.430</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.430</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.430</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.430</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
</pre></div>
</div>
<p>The script is listed below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sse</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">sse</span><span class="o">=</span><span class="mf">0.0</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">sse</span><span class="o">=</span><span class="n">sse</span><span class="o">+</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">-</span><span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span><span class="p">(</span><span class="n">sse</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="c1">##print(nr,nc)</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="c1">##print(ir,jc)</span>
            <span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">=</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span>
    <span class="k">return</span><span class="p">(</span><span class="n">matrix2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">writearray</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="n">new_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>    
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">new_list</span><span class="p">[</span><span class="n">ir</span><span class="p">][:])</span>
    <span class="k">return</span><span class="p">()</span>

<span class="n">localfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;input5.txt&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="c1"># connect and read file for 2D gw model</span>
<span class="n">deltax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltay</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltaz</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">tolerance</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">maxiter</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">distancex</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancex</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">distancey</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancey</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarytop</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarytop</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarybottom</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarybottom</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryleft</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryleft</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryright</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryright</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">head</span> <span class="o">=</span><span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">head</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1">#writearray(head)</span>
<span class="n">hydcondx</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondx</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1">#writearray(hydcondx)</span>
<span class="n">hydcondy</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondy</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1">#writearray(hydcondy)</span>
<span class="n">pumping</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">pumping</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1">#writearray(pumping)</span>
<span class="n">localfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="c1"># Disconnect the file</span>
<span class="c1">##</span>
<span class="n">amat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">bmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">cmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">dmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">qrat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="c1">## Transmissivity Arrays</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">## Net Pumping Array</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="n">qrat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">pumping</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">])</span> <span class="o">/</span><span class="p">(</span><span class="n">deltax</span><span class="o">*</span><span class="n">deltay</span><span class="p">)</span>
<span class="c1">## Headold array</span>
<span class="n">headold</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span> <span class="c1">#force a new matrix</span>
<span class="n">headold</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span> <span class="c1"># update</span>
<span class="c1">##writearray(head)</span>
<span class="c1">##print(&quot;----&quot;)</span>
<span class="c1">##writearray(headold)</span>
<span class="c1">##print(&quot;--------&quot;)</span>
<span class="n">tolflag</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">for</span> <span class="nb">iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxiter</span><span class="p">):</span>
<span class="c1">##    print(&quot;begin iteration&quot;)</span>
<span class="c1">##    writearray(head)</span>
<span class="c1">##    print(&quot;----&quot;)</span>
<span class="c1">##    writearray(headold)</span>
<span class="c1">##    print(&quot;--------&quot;)</span>

<span class="c1"># Boundary Conditions</span>

<span class="c1"># first and last row special == no flow boundaries</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">boundarytop</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at top</span>
            <span class="n">head</span> <span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
        <span class="k">if</span> <span class="n">boundarybottom</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">jcol</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at bottom</span>
            <span class="n">head</span> <span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
<span class="c1"># first and last column special == no flow boundaries     </span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span> 
        <span class="k">if</span>  <span class="n">boundaryleft</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># no - flow at left</span>
        <span class="k">if</span> <span class="n">boundaryright</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
            <span class="n">head</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span> <span class="n">irow</span> <span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># no - flow at right</span>
<span class="c1"># interior updates</span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">qrat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> 
                              <span class="o">+</span><span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                              <span class="o">+</span><span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                              <span class="o">+</span><span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
                              <span class="o">+</span><span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">amat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">bmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">cmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">dmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">])</span>
<span class="c1"># test for stopping iterations</span>
<span class="c1">##    print(&quot;end iteration&quot;)</span>
<span class="c1">##    writearray(head)</span>
<span class="c1">##    print(&quot;----&quot;)</span>
<span class="c1">##    writearray(headold)</span>
    <span class="n">percentdiff</span> <span class="o">=</span> <span class="n">sse</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span>
    <span class="k">if</span>  <span class="n">percentdiff</span> <span class="o">&lt;=</span> <span class="n">tolerance</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exit iterations in velocity potential because tolerance met &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations =&quot;</span> <span class="p">,</span> <span class="nb">iter</span><span class="o">+</span><span class="mi">1</span> <span class="p">)</span> <span class="p">;</span>
        <span class="n">tolflag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">break</span>
    <span class="n">headold</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;End Calculations&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations    = &quot;</span><span class="p">,</span><span class="nb">iter</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Closure Error = &quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">percentdiff</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="c1"># special messaging to report min head to adjust pump rates</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Minimum Head&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span><span class="mi">3</span><span class="p">))</span>
<span class="c1">#</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Head Map&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
<span class="n">writearray</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exit iterations in velocity potential because tolerance met 
Iterations = 806
End Calculations
Iterations    =  806
Closure Error =  0.0
Minimum Head 15.09
Head Map
----
0 [30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30.
 30. 30. 30. 30. 30. 30. 30. 30. 30. 30.]
1 [30.    29.914 29.828 29.743 29.659 29.577 29.499 29.426 29.36  29.303
 29.258 29.225 29.206 29.202 29.211 29.235 29.271 29.318 29.374 29.436
 29.503 29.572 29.643 29.715 29.787 29.858 29.929 30.   ]
2 [30.    29.827 29.655 29.484 29.315 29.15  28.992 28.844 28.71  28.595
 28.502 28.436 28.398 28.389 28.409 28.457 28.531 28.627 28.74  28.867
 29.002 29.143 29.286 29.43  29.574 29.716 29.858 30.   ]
3 [30.    29.74  29.481 29.223 28.968 28.717 28.476 28.248 28.042 27.864
 27.721 27.619 27.56  27.547 27.579 27.654 27.769 27.918 28.094 28.29
 28.497 28.711 28.928 29.145 29.361 29.575 29.788 30.   ]
4 [30.    29.653 29.306 28.96  28.615 28.275 27.945 27.632 27.346 27.098
 26.899 26.757 26.677 26.66  26.705 26.811 26.973 27.183 27.429 27.7
 27.985 28.277 28.57  28.862 29.151 29.436 29.719 30.   ]
5 [30.    29.566 29.131 28.695 28.258 27.823 27.397 26.988 26.611 26.282
 26.019 25.835 25.732 25.711 25.771 25.911 26.129 26.411 26.739 27.096
 27.466 27.841 28.214 28.582 28.943 29.299 29.651 30.   ]
6 [30.    29.48  28.957 28.43  27.898 27.363 26.831 26.313 25.828 25.401
 25.061 24.83  24.706 24.681 24.755 24.935 25.221 25.593 26.021 26.477
 26.943 27.407 27.863 28.308 28.742 29.167 29.585 30.   ]
7 [30.    29.396 28.787 28.17  27.541 26.901 26.252 25.606 24.986 24.431
 23.995 23.719 23.58  23.552 23.633 23.851 24.228 24.72  25.273 25.849
 26.422 26.982 27.522 28.044 28.549 29.041 29.523 30.   ]
8 [30.    29.317 28.626 27.922 27.196 26.446 25.67  24.873 24.079 23.344
 22.769 22.47  22.344 22.312 22.375 22.61  23.118 23.784 24.505 25.223
 25.915 26.575 27.201 27.798 28.37  28.924 29.465 30.   ]
9 [30.    29.245 28.479 27.693 26.877 26.018 25.107 24.137 23.115 22.095
 21.268 21.048 21.013 20.979 20.945 21.096 21.85  22.795 23.738 24.622
 25.442 26.201 26.909 27.576 28.21  28.82  29.414 30.   ]
10 [30.    29.183 28.353 27.496 26.599 25.642 24.604 23.453 22.147 20.653
 19.161 19.44  19.681 19.645 19.332 18.978 20.393 21.807 23.028 24.088
 25.028 25.878 26.659 27.386 28.074 28.732 29.37  30.   ]
11 [30.    29.134 28.253 27.341 26.379 25.347 24.213 22.925 21.368 19.208
 15.281 17.872 18.626 18.589 17.758 15.09  18.937 21.012 22.481 23.673
 24.704 25.624 26.462 27.238 27.967 28.662 29.336 30.   ]
12 [30.    29.1   28.184 27.234 26.231 25.154 23.976 22.667 21.19  19.531
 17.916 18.139 18.364 18.325 18.022 17.719 19.252 20.824 22.209 23.42
 24.491 25.452 26.327 27.135 27.893 28.615 29.313 30.   ]
13 [30.    29.083 28.149 27.18  26.157 25.061 23.872 22.577 21.193 19.812
 18.711 18.405 18.364 18.325 18.286 18.511 19.528 20.821 22.112 23.307
 24.388 25.366 26.259 27.083 27.856 28.591 29.301 30.   ]
14 [30.    29.083 28.149 27.18  26.157 25.061 23.872 22.577 21.193 19.812
 18.711 18.405 18.364 18.325 18.286 18.511 19.528 20.821 22.112 23.307
 24.388 25.366 26.259 27.083 27.856 28.591 29.301 30.   ]
15 [30.    29.1   28.184 27.234 26.231 25.154 23.976 22.667 21.19  19.531
 17.916 18.139 18.364 18.325 18.022 17.719 19.252 20.824 22.209 23.42
 24.491 25.452 26.327 27.135 27.893 28.615 29.313 30.   ]
16 [30.    29.134 28.253 27.341 26.379 25.347 24.213 22.925 21.368 19.208
 15.281 17.872 18.626 18.589 17.758 15.09  18.937 21.012 22.481 23.673
 24.704 25.624 26.462 27.238 27.967 28.662 29.336 30.   ]
17 [30.    29.183 28.353 27.496 26.599 25.642 24.604 23.453 22.147 20.653
 19.161 19.44  19.681 19.645 19.332 18.978 20.393 21.807 23.028 24.088
 25.028 25.878 26.659 27.386 28.074 28.732 29.37  30.   ]
18 [30.    29.245 28.479 27.693 26.877 26.018 25.107 24.137 23.115 22.095
 21.268 21.048 21.013 20.979 20.945 21.096 21.85  22.795 23.738 24.622
 25.442 26.201 26.909 27.576 28.21  28.82  29.414 30.   ]
19 [30.    29.317 28.626 27.922 27.196 26.446 25.67  24.873 24.079 23.344
 22.769 22.47  22.344 22.312 22.375 22.61  23.118 23.784 24.504 25.223
 25.915 26.575 27.201 27.798 28.37  28.924 29.465 30.   ]
20 [30.    29.396 28.787 28.17  27.541 26.901 26.252 25.606 24.986 24.431
 23.995 23.719 23.58  23.552 23.633 23.851 24.228 24.72  25.273 25.849
 26.422 26.982 27.522 28.044 28.549 29.041 29.523 30.   ]
21 [30.    29.48  28.957 28.43  27.898 27.363 26.831 26.313 25.828 25.401
 25.061 24.83  24.706 24.681 24.755 24.935 25.221 25.593 26.021 26.477
 26.943 27.407 27.863 28.308 28.742 29.167 29.585 30.   ]
22 [30.    29.566 29.131 28.695 28.258 27.823 27.397 26.988 26.611 26.282
 26.019 25.835 25.732 25.711 25.771 25.911 26.129 26.411 26.739 27.096
 27.466 27.841 28.214 28.582 28.943 29.299 29.651 30.   ]
23 [30.    29.653 29.306 28.96  28.615 28.275 27.945 27.632 27.346 27.098
 26.899 26.757 26.677 26.66  26.705 26.811 26.973 27.183 27.429 27.7
 27.985 28.277 28.57  28.862 29.151 29.436 29.719 30.   ]
24 [30.    29.74  29.481 29.223 28.968 28.717 28.476 28.248 28.042 27.864
 27.721 27.619 27.56  27.547 27.579 27.654 27.769 27.918 28.094 28.29
 28.497 28.711 28.928 29.145 29.361 29.575 29.788 30.   ]
25 [30.    29.827 29.655 29.484 29.315 29.15  28.992 28.844 28.71  28.595
 28.502 28.436 28.398 28.389 28.409 28.457 28.531 28.627 28.74  28.867
 29.002 29.143 29.286 29.43  29.574 29.716 29.858 30.   ]
26 [30.    29.914 29.828 29.743 29.659 29.577 29.499 29.426 29.36  29.303
 29.258 29.225 29.206 29.202 29.211 29.235 29.271 29.318 29.374 29.436
 29.503 29.572 29.643 29.715 29.787 29.858 29.929 30.   ]
27 [30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30.
 30. 30. 30. 30. 30. 30. 30. 30. 30. 30.]
----
</pre></div>
</div>
</div>
</div>
<p>Then the contour plot</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://clouds.eos.ubc.ca/~phil/docs/problem_solving/06-Plotting-with-Matplotlib/06.14-Contour-Plots.html</span>
<span class="c1"># https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.griddata.html</span>
<span class="c1"># https://stackoverflow.com/questions/332289/how-do-you-change-the-size-of-figures-drawn-with-matplotlib</span>
<span class="c1"># https://stackoverflow.com/questions/18730044/converting-two-lists-into-a-matrix</span>
<span class="c1"># https://stackoverflow.com/questions/3242382/interpolation-over-an-irregular-grid</span>
<span class="c1"># https://stackoverflow.com/questions/33919875/interpolate-irregular-3d-data-from-a-xyz-file-to-a-regular-grid</span>
<span class="c1"># build XYZ structure from head map</span>
<span class="n">my_xyz</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="n">my_xyz</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">distancex</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">],</span><span class="n">distancey</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">irow</span><span class="p">],</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]])</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="n">my_xyz</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">my_xyz</span><span class="p">)</span> <span class="c1"># convert into a data frame</span>
<span class="c1">#print(my_xyz) # activate to examine the dataframe</span>
<span class="kn">import</span> <span class="nn">numpy</span> 
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>
<span class="c1"># extract lists from the dataframe</span>
<span class="n">coord_x</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 0 of dataframe</span>
<span class="n">coord_y</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 1 of dataframe</span>
<span class="n">coord_z</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 2 of dataframe</span>
<span class="n">coord_xy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">coord_x</span><span class="p">,</span> <span class="n">coord_y</span><span class="p">))</span>
<span class="c1"># Set plotting range in original data units</span>
<span class="n">lon</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">lat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="mi">80</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
<span class="c1"># Grid the data; use linear interpolation (choices are nearest, linear, cubic)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_xy</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_z</span><span class="p">),</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="c1"># Build the map</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Contour Plot from Gridded Data File&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Contour Plot from Gridded Data File&#39;)
</pre></div>
</div>
<img alt="../../_images/13gwmodels_26_1.png" src="../../_images/13gwmodels_26_1.png" />
</div>
</div>
<p>The contour plot shows the “cone of depression” around the well field. The script has an added message that reports the smallest head, and that report was used to adjust the pumping rates at the four wells until the value is close to the prescribed 15 meters.</p>
<p>The value for a single well is <span class="math notranslate nohighlight">\(0.430 m^3/day\)</span> (using the units of hydraulic conductivity as a guide). If the goal was then to specify particular pumps, that flow value and the required lift would be used to specify and purchase pumps for the system. We will repeat the problem in the next section of the workbook, except the aquifer
will be unconfined — we expect different results, but will be able to re-use the input file.</p>
</div>
</div>
<div class="section" id="unconfined-aquifer-flow">
<h2>Unconfined Aquifer Flow<a class="headerlink" href="#unconfined-aquifer-flow" title="Permalink to this headline">¶</a></h2>
<p>Unconfined aquifer flow is simply a replacement of the transmissivity term by the product of saturated thickness and hydraulic conductivity.</p>
<div class="math notranslate nohighlight">
\[
S \frac{\partial h}{\partial t} = 
\frac{\partial}{\partial x}({K_x \bar h \frac{\partial h}{\partial x}}) +
\frac{\partial}{\partial y}({K_y \bar h \frac{\partial h}{\partial y}}) + R - Q
\]</div>
<p>As a difference equation it becomes</p>
<div class="math notranslate nohighlight">
\[ 
S \frac{\partial h_{i,j}}{\partial t} = [ \frac{1}{\Delta x} K_x \bar h \frac{h_{i−1,j} − h_{i,j}}{\Delta x} + \frac{1}{\Delta y} K_y \bar h \frac{h_{i,j-1} − h_{i,j}}{\Delta y}]-[\frac{1}{\Delta x} K_x \bar h \frac{h_{i,j} − h_{i+1,j}}{\Delta x} + \frac{1}{\Delta y} K_y \bar h \frac{h_{i,j} − h_{i,j+1}}{\Delta y}] + \frac{R_{i,j}}{\Delta x \Delta y} - \frac{Q_{i,j}}{\Delta x \Delta y}
\]</div>
<p>Using the same spatial variation scheme we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A_{i,j} = \frac{1}{2∆x^2} (K_{x,(i−1,j)} h_{i−1,j} + K_{x,(i,j)} h_{i−1,j})\\
B_{i,j} = \frac{1}{2∆x^2} (K_{x,(i,j)} h_{i,j} + K_{x,(i+1,j)} h_{i+1,j})\\
C_{i,j} = \frac{1}{2∆y^2} (K_{y,(i,j−1)} h_{i,j-1} + K_{y,(i,j)} h_{i,j})\\
D_{i,j} = \frac{1}{2∆y^2} (K_{y,(i,j)} h_{i,j} + K_{y,(i,j+1)} h_{i,j+1})\\
\end{split}\]</div>
<p>As before we can explicitly write the cell equation for <span class="math notranslate nohighlight">\(h_{i,j}\)</span>, however the system
is non-linear so the A, B, C, D coefficients are themselves functions of the current cell
values.</p>
<p>This difference equation represents an approximation to the governing flow equation,
the accuracy depending on the cell size. Boundary conditions are applied directly
into the analogs (another name for the difference equations) at appropriate locations
on the computational grid. Also as in the one-dimensional case we can generate
solutions either by iteration or solving the resulting non-linear system. Fortunately
theses kinds of systems are pretty well conditioned and one can usually compute the
<span class="math notranslate nohighlight">\(A, B, C, D\)</span> coefficients from the most recent value (in an iterative sense) of <span class="math notranslate nohighlight">\(h\)</span> and
proceeds as if the system is linear and it usually eventually converges.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The approach here is called the variable transmissivity approach – as long as there is not too much curvature in the head distribution or dramatic changes in material properties in adjacent cells the Jacobi iteration method
already employed will function, albeit slowly compared to more elaborate methods. In this discourse
we are satisfied with these relatively primitive constructs, and more sophisticated approaches are
presented elsewhere.</p>
</div>
<div class="section" id="homebrew-example-6-wells-in-a-rectangular-unconfined-aquifer">
<h3>Homebrew - Example 6: Wells in a rectangular unconfined aquifer<a class="headerlink" href="#homebrew-example-6-wells-in-a-rectangular-unconfined-aquifer" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="#wells-unconfined"><span class="std std-numref">Fig. 25</span></a> is a rectangular aquifer with 4 wells as shown – the drawing is identi-
cal to the previous example, except the aquifer is now an unconfined aquifer.</p>
<p>The saturated thickness before the pumps are turned on is 30 meters. The aquifer is sur-
rounded with a constant head boundary of 30 meters. The hydraulic conductivity is
K = 0.033 m/day.</p>
<div class="figure align-default" id="wells-unconfined">
<a class="reference internal image-reference" href="../../_images/4wells-unconfined.png"><img alt="../../_images/4wells-unconfined.png" src="../../_images/4wells-unconfined.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 25 </span><span class="caption-text">Unconfined rectangular aquifer with 4 wells.</span><a class="headerlink" href="#wells-unconfined" title="Permalink to this image">¶</a></p>
</div>
<p>Using a 10 meter × 10 meter grid spacing estimate the pumping rate in each well
so that the head within the rectangular area defined by the well field is no less
than 15 meters. In this example, the pumping rates will be quite a bit larger because
the saturated thickness at the desired drawdown is 15 times larger that the previous
example.</p>
<p>The listing below  is a script that performs the indicated computations. Upon initial inspection it appears nearly identical to the confined flow script, except the <span class="math notranslate nohighlight">\(A, B, C, D\)</span> computations are moved into the iteration loop, so they are updated after each iteration.</p>
<p>Observe that the <span class="math notranslate nohighlight">\(∆z\)</span> value is still read into the script, but never used. We are being
somewhat lazy here; however it illustrates a code development protocol to re-use as
much code as possible until the program functions as desired, then we could go back
and delete unused components. I choose to retain the <span class="math notranslate nohighlight">\(∆z\)</span> so I would only have to
change the input file pumping array and not create an entirely new input file structure.
As stated earlier, as the problems get big, we would write scripts that build the input
files before we run the computation engines.</p>
<p><strong>input6.txt</strong> Relevant portion of the input file for the example. The remainder of
the file is unchanged from the previous example (hence the reason I retained the ∆z
variable).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">9.710</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">9.710</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">9.710</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">9.710</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sse</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">sse</span><span class="o">=</span><span class="mf">0.0</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">sse</span><span class="o">=</span><span class="n">sse</span><span class="o">+</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">-</span><span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span><span class="p">(</span><span class="n">sse</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="c1">##print(nr,nc)</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="c1">##print(ir,jc)</span>
            <span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">=</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span>
    <span class="k">return</span><span class="p">(</span><span class="n">matrix2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">writearray</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="n">new_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>    
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">new_list</span><span class="p">[</span><span class="n">ir</span><span class="p">][:])</span>
    <span class="k">return</span><span class="p">()</span>

<span class="n">localfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;input6.txt&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="c1"># connect and read file for 2D gw model</span>
<span class="n">deltax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltay</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltaz</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">tolerance</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">maxiter</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">distancex</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancex</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">distancey</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancey</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarytop</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarytop</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarybottom</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarybottom</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryleft</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryleft</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryright</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryright</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">head</span> <span class="o">=</span><span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">head</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1">#writearray(head)</span>
<span class="n">hydcondx</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondx</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1">#writearray(hydcondx)</span>
<span class="n">hydcondy</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondy</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1">#writearray(hydcondy)</span>
<span class="n">pumping</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">pumping</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1">#writearray(pumping)</span>
<span class="n">localfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="c1"># Disconnect the file</span>
<span class="c1">##</span>
<span class="n">amat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">bmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">cmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">dmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">qrat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="c1">## Net Pumping Array</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="n">qrat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">pumping</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">])</span> <span class="o">/</span><span class="p">(</span><span class="n">deltax</span><span class="o">*</span><span class="n">deltay</span><span class="p">)</span>
<span class="c1">## Headold array</span>
<span class="n">headold</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span> <span class="c1">#force a new matrix</span>
<span class="n">headold</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span> <span class="c1"># update</span>
<span class="c1">##writearray(head)</span>
<span class="c1">##print(&quot;----&quot;)</span>
<span class="c1">##writearray(headold)</span>
<span class="c1">##print(&quot;--------&quot;)</span>
<span class="n">tolflag</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">for</span> <span class="nb">iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxiter</span><span class="p">):</span>
<span class="c1">##    print(&quot;begin iteration&quot;)</span>
<span class="c1">##    writearray(head)</span>
<span class="c1">##    print(&quot;----&quot;)</span>
<span class="c1">##    writearray(headold)</span>
<span class="c1">##    print(&quot;--------&quot;)</span>
<span class="c1">## Transmissivity Arrays</span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> <span class="o">*</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> <span class="o">*</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> <span class="o">*</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> <span class="o">*</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span> <span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> <span class="o">*</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> <span class="o">*</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Boundary Conditions</span>

<span class="c1"># first and last row special == no flow boundaries</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">boundarytop</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at top</span>
            <span class="n">head</span> <span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
        <span class="k">if</span> <span class="n">boundarybottom</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">jcol</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at bottom</span>
            <span class="n">head</span> <span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
<span class="c1"># first and last column special == no flow boundaries     </span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span> 
        <span class="k">if</span>  <span class="n">boundaryleft</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># no - flow at left</span>
        <span class="k">if</span> <span class="n">boundaryright</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
            <span class="n">head</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span> <span class="n">irow</span> <span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># no - flow at right</span>

<span class="c1"># interior updates</span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">qrat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> 
                              <span class="o">+</span><span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                              <span class="o">+</span><span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                              <span class="o">+</span><span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
                              <span class="o">+</span><span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">amat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">bmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">cmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">dmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">])</span>
<span class="c1"># test for stopping iterations</span>
<span class="c1">##    print(&quot;end iteration&quot;)</span>
<span class="c1">##    writearray(head)</span>
<span class="c1">##    print(&quot;----&quot;)</span>
<span class="c1">##    writearray(headold)</span>
    <span class="n">percentdiff</span> <span class="o">=</span> <span class="n">sse</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span>
    <span class="k">if</span>  <span class="n">percentdiff</span> <span class="o">&lt;=</span> <span class="n">tolerance</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exit iterations in velocity potential because tolerance met &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations =&quot;</span> <span class="p">,</span> <span class="nb">iter</span><span class="o">+</span><span class="mi">1</span> <span class="p">)</span> <span class="p">;</span>
        <span class="n">tolflag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">break</span>
    <span class="n">headold</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;End Calculations&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations    = &quot;</span><span class="p">,</span><span class="nb">iter</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Closure Error = &quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">percentdiff</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="c1"># special messaging to report min head to adjust pump rates</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Minimum Head&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span><span class="mi">3</span><span class="p">))</span>
<span class="c1">#</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Head Map&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
<span class="n">writearray</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exit iterations in velocity potential because tolerance met 
Iterations = 807
End Calculations
Iterations    =  807
Closure Error =  0.0
Minimum Head 15.054
Head Map
----
0 [30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30.
 30. 30. 30. 30. 30. 30. 30. 30. 30. 30.]
1 [30.    29.935 29.87  29.806 29.742 29.68  29.62  29.564 29.514 29.471
 29.436 29.411 29.396 29.393 29.4   29.418 29.446 29.482 29.525 29.572
 29.623 29.676 29.73  29.785 29.839 29.893 29.947 30.   ]
2 [30.    29.87  29.739 29.609 29.48  29.354 29.232 29.117 29.013 28.923
 28.851 28.799 28.769 28.762 28.778 28.815 28.873 28.948 29.036 29.135
 29.24  29.348 29.458 29.568 29.677 29.786 29.893 30.   ]
3 [30.    29.804 29.607 29.409 29.213 29.018 28.83  28.651 28.488 28.346
 28.232 28.15  28.104 28.093 28.119 28.179 28.271 28.39  28.53  28.684
 28.847 29.014 29.182 29.35  29.515 29.679 29.84  30.   ]
4 [30.    29.738 29.473 29.207 28.939 28.672 28.411 28.161 27.931 27.729
 27.567 27.451 27.385 27.371 27.408 27.495 27.628 27.799 27.998 28.216
 28.443 28.674 28.904 29.131 29.354 29.572 29.788 30.   ]
5 [30.    29.672 29.339 29.001 28.659 28.314 27.972 27.64  27.33  27.057
 26.837 26.681 26.594 26.576 26.627 26.746 26.929 27.165 27.436 27.728
 28.028 28.328 28.624 28.913 29.194 29.468 29.736 30.   ]
6 [30.    29.606 29.204 28.794 28.374 27.945 27.512 27.083 26.675 26.311
 26.018 25.817 25.708 25.686 25.751 25.908 26.157 26.476 26.838 27.219
 27.603 27.98  28.346 28.698 29.037 29.366 29.686 30.   ]
7 [30.    29.542 29.073 28.589 28.088 27.569 27.032 26.487 25.953 25.466
 25.076 24.826 24.699 24.673 24.748 24.946 25.284 25.72  26.202 26.693
 27.174 27.635 28.073 28.49  28.887 29.269 29.639 30.   ]
8 [30.    29.481 28.947 28.392 27.81  27.194 26.541 25.854 25.152 24.482
 23.947 23.663 23.542 23.512 23.572 23.796 24.273 24.885 25.531 26.158
 26.749 27.3   27.814 28.294 28.747 29.179 29.595 30.   ]
9 [30.    29.426 28.833 28.21  27.549 26.836 26.058 25.203 24.27  23.302
 22.487 22.264 22.229 22.194 22.16  22.313 23.064 23.971 24.843 25.635
 26.346 26.989 27.576 28.116 28.621 29.098 29.556 30.   ]
10 [30.    29.379 28.733 28.052 27.32  26.517 25.618 24.583 23.352 21.86
 20.26  20.569 20.832 20.793 20.45  20.055 21.59  23.021 24.19  25.159
 25.989 26.718 27.37  27.964 28.513 29.03  29.522 30.   ]
11 [30.    29.341 28.655 27.927 27.138 26.265 25.272 24.093 22.586 20.313
 15.339 18.768 19.655 19.612 18.631 15.054 20.009 22.228 23.673 24.784
 25.706 26.502 27.207 27.843 28.428 28.976 29.496 30.   ]
12 [30.    29.315 28.601 27.84  27.015 26.099 25.059 23.85  22.408 20.669
 18.821 19.087 19.351 19.306 18.948 18.583 20.361 22.036 23.413 24.553
 25.519 26.355 27.095 27.76  28.37  28.939 29.478 30.   ]
13 [30.    29.302 28.573 27.797 26.953 26.018 24.964 23.765 22.411 20.973
 19.752 19.399 19.352 19.306 19.26  19.522 20.665 22.033 23.319 24.448
 25.427 26.282 27.038 27.718 28.34  28.92  29.469 30.   ]
14 [30.    29.302 28.573 27.797 26.953 26.018 24.964 23.765 22.411 20.973
 19.752 19.399 19.352 19.306 19.26  19.522 20.665 22.033 23.319 24.448
 25.427 26.282 27.038 27.718 28.34  28.92  29.469 30.   ]
15 [30.    29.315 28.601 27.84  27.015 26.099 25.059 23.85  22.408 20.669
 18.821 19.087 19.351 19.306 18.948 18.583 20.361 22.036 23.413 24.553
 25.519 26.355 27.095 27.76  28.37  28.939 29.478 30.   ]
16 [30.    29.341 28.655 27.927 27.138 26.265 25.272 24.093 22.586 20.313
 15.338 18.768 19.655 19.612 18.631 15.054 20.009 22.228 23.673 24.784
 25.706 26.502 27.207 27.843 28.428 28.976 29.496 30.   ]
17 [30.    29.379 28.733 28.052 27.32  26.517 25.618 24.583 23.352 21.86
 20.26  20.569 20.832 20.793 20.45  20.055 21.59  23.021 24.19  25.159
 25.989 26.718 27.37  27.964 28.513 29.03  29.522 30.   ]
18 [30.    29.426 28.833 28.21  27.549 26.836 26.058 25.203 24.27  23.302
 22.487 22.264 22.229 22.194 22.16  22.313 23.064 23.971 24.843 25.635
 26.346 26.989 27.575 28.116 28.621 29.098 29.556 30.   ]
19 [30.    29.481 28.947 28.392 27.81  27.194 26.541 25.854 25.152 24.482
 23.947 23.663 23.542 23.512 23.572 23.796 24.273 24.885 25.531 26.158
 26.749 27.3   27.814 28.294 28.747 29.179 29.595 30.   ]
20 [30.    29.542 29.073 28.589 28.088 27.569 27.032 26.487 25.953 25.466
 25.076 24.826 24.699 24.673 24.748 24.946 25.284 25.72  26.202 26.693
 27.174 27.635 28.073 28.49  28.887 29.269 29.639 30.   ]
21 [30.    29.606 29.204 28.794 28.374 27.945 27.512 27.083 26.675 26.311
 26.018 25.817 25.708 25.686 25.751 25.908 26.157 26.476 26.838 27.219
 27.603 27.98  28.346 28.698 29.037 29.366 29.686 30.   ]
22 [30.    29.672 29.339 29.001 28.659 28.314 27.972 27.64  27.33  27.057
 26.837 26.681 26.594 26.576 26.627 26.746 26.929 27.165 27.436 27.728
 28.028 28.328 28.624 28.913 29.194 29.468 29.736 30.   ]
23 [30.    29.738 29.473 29.207 28.939 28.672 28.411 28.161 27.931 27.729
 27.567 27.451 27.385 27.371 27.408 27.495 27.628 27.799 27.998 28.216
 28.443 28.674 28.904 29.131 29.354 29.572 29.788 30.   ]
24 [30.    29.804 29.607 29.409 29.213 29.018 28.83  28.651 28.488 28.346
 28.232 28.15  28.104 28.093 28.118 28.179 28.271 28.39  28.53  28.684
 28.847 29.014 29.182 29.35  29.515 29.679 29.84  30.   ]
25 [30.    29.87  29.739 29.609 29.48  29.354 29.232 29.117 29.013 28.923
 28.851 28.799 28.769 28.762 28.778 28.815 28.873 28.948 29.036 29.135
 29.24  29.348 29.458 29.568 29.677 29.786 29.893 30.   ]
26 [30.    29.935 29.87  29.806 29.742 29.68  29.62  29.564 29.514 29.471
 29.436 29.411 29.396 29.393 29.4   29.418 29.446 29.482 29.525 29.572
 29.623 29.676 29.73  29.785 29.839 29.893 29.947 30.   ]
27 [30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30. 30.
 30. 30. 30. 30. 30. 30. 30. 30. 30. 30.]
----
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://clouds.eos.ubc.ca/~phil/docs/problem_solving/06-Plotting-with-Matplotlib/06.14-Contour-Plots.html</span>
<span class="c1"># https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.griddata.html</span>
<span class="c1"># https://stackoverflow.com/questions/332289/how-do-you-change-the-size-of-figures-drawn-with-matplotlib</span>
<span class="c1"># https://stackoverflow.com/questions/18730044/converting-two-lists-into-a-matrix</span>
<span class="c1"># https://stackoverflow.com/questions/3242382/interpolation-over-an-irregular-grid</span>
<span class="c1"># https://stackoverflow.com/questions/33919875/interpolate-irregular-3d-data-from-a-xyz-file-to-a-regular-grid</span>
<span class="c1"># build XYZ structure from head map</span>
<span class="n">my_xyz</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="n">my_xyz</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">distancex</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">],</span><span class="n">distancey</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">irow</span><span class="p">],</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]])</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="n">my_xyz</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">my_xyz</span><span class="p">)</span> <span class="c1"># convert into a data frame</span>
<span class="c1">#print(my_xyz) # activate to examine the dataframe</span>
<span class="kn">import</span> <span class="nn">numpy</span> 
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>
<span class="c1"># extract lists from the dataframe</span>
<span class="n">coord_x</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 0 of dataframe</span>
<span class="n">coord_y</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 1 of dataframe</span>
<span class="n">coord_z</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 2 of dataframe</span>
<span class="n">coord_xy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">coord_x</span><span class="p">,</span> <span class="n">coord_y</span><span class="p">))</span>
<span class="c1"># Set plotting range in original data units</span>
<span class="n">lon</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">lat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="mi">80</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
<span class="c1"># Grid the data; use linear interpolation (choices are nearest, linear, cubic)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_xy</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_z</span><span class="p">),</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="c1"># Build the map</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Contour Plot from Gridded Data File&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Contour Plot from Gridded Data File&#39;)
</pre></div>
</div>
<img alt="../../_images/13gwmodels_31_1.png" src="../../_images/13gwmodels_31_1.png" />
</div>
</div>
<p>The plot is practically
the same as in the previous example (in fact of the labels were not moved on the
contour lines, the figures would look identical) however the pumping rate is 20 times
larger for apparently the same head distribution — so if the dewatering effort were
in an unconfined aquifer, perhaps for an excavation for a foundation, choosing the
correct conditions would be kind of important.</p>
</div>
</div>
<div class="section" id="interim-summary">
<h2>Interim Summary<a class="headerlink" href="#interim-summary" title="Permalink to this headline">¶</a></h2>
<p>As a quick summary of this chapter we started with a 1D situation and built a finite-difference models to illustrate the structure for the Jacobi iteration method. Next we progressed to a 2D situation (it can either be a
slice or a layer) and used the Jacobi iteration method.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using a formal linear solver
would also work quite well, but the matrix assembly is a bit tedious – so that was left
unaddressed.</p>
</div>
<p>Once we had the 2D computation engine working we extended capability by adding generalized boundary condition capability to the exterior boundaries (the same can be done for interior cells – the matrix assembly logic
is awkward, so that too is left undone). Once the generalized boundary
modification was built, we then added a recharge/pumping capability.</p>
<p>This last model
is functionally useful (although it needs testing against known solutions to detect any
coding errors). To complete the discussion, a simple modification using the variable
transmissivity construct allowed us to extend our capability to unconfined aquifers.
The next chapter will illustrate unsteady flow where the left hand side of the PDEs
is no longer zero.</p>
<p>1D cases were not explicitly explored, however the tool so far can handle such cases by making the
model 3 cells wide in the un-needed axis and it will accomplish the same goal (and avoid having separate codes for different dimensions).</p>
</div>
<div class="toctree-wrapper compound">
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./lessons/groundwatermodels"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="../12gwflow2wells/12gwflow2wells.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Groundwater Flow to Wells IV</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="14gwmodels.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Transient Groundwater Models</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Theodore G. Cleveland, Ph.D., P.E., M.ASCE, F.EWRI<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>