
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Transient Groundwater Models &#8212; CE 4363/5363 Groundwater Hydrology</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="MODFLOW Program" href="15gwmodels.html" />
    <link rel="prev" title="Groundwater Models" href="13gwmodels.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo2.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">CE 4363/5363 Groundwater Hydrology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Welcome to CE 4363/5363 Groundwater Hydrology
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../00introduction/00introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01computationaltools/01computationaltools.html">
   Computational Tools
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02water/02water.html">
   Water (Fetter pp. 1-23)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03aquiferproperties/03aquiferproperties.html">
   Aquifer Properties - I (pp. 66-93)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04aquiferproperties/04aquiferproperties.html">
   Aquifer Properties - II (pp. 93-109)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../05gwflowprinciples/05gwflowprinciples.html">
   Groundwater Flow Principles (pp. 118 - 127)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../06gwflowequations/06gwflowequations.html">
   Groundwater Flow Equations (pp. 130-135; XX-XX)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../07gwflow1Dsolutions/07gwflow1Dsolutions.html">
   Groundwater Flow Solutions (pp. 143-151; 171-175)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../08gwflow2wells/08gwflow2wells.html">
   Groundwater Flow to Wells - I (pp. 156-162)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../09gwflow2wells/09gwflow2wells.html">
   Groundwater Flow to Wells - II (pp. 162 - 166)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../10gwflow2wells/10gwflow2wells.html">
   Groundwater Flow to Wells - III (pp. 172-212)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../11gwflow2wells/11gwflow2wells.html">
   Groundwater Flow to Wells - IV
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../12gwflow2wells/12gwflow2wells.html">
   Groundwater Flow to Wells IV
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="13gwmodels.html">
   Groundwater Models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Transient Groundwater Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="15gwmodels.html">
     MODFLOW Program
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="15gwmodels-examples.html">
     MODFLOW Python Interface Examples
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="15gwmodels-examples-2.html">
     MODFLOW Python Interface Examples
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="16gwmodels-examples-3.html">
     MODFLOW Python Interface Examples
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="16gwmodels.html">
     Regional Flow (pp. 244)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../16recharge.html">
   Recharge
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16project.html">
   Semester Project - in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../17fieldmethods.html">
   Field Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../18waterwellconstruction.html">
   Water Well Construction - I
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../19waterwellconstruction.html">
   Water Well Construction - II
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../20gwchemistry.html">
   Groundwater Chemistry (pp. 351-392)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../21gwchemistry.html">
   Groundwater Chemistry - II
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../22gwcontamination.html">
   Groundwater Contamination - I
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../23gwcontamination.html">
   Groundwater Contamination - II
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../24contaminanttransport.html">
   Contaminant Transport
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../25gwdevelopment.html">
   Groundwater Development and Management
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../26waterlaw.html">
   Water Law
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/lessons/groundwatermodels/14gwmodels.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Flessons/groundwatermodels/14gwmodels.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/lessons/groundwatermodels/14gwmodels.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#confined-aquifers">
   Confined Aquifers
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#homebrew-example-7-rectangular-aquifer-with-pumping-unsteady-flow">
     Homebrew - Example 7: Rectangular Aquifer with Pumping – Unsteady Flow
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#unconfined-aquifers">
   Unconfined Aquifers
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#homebrew-example-8-unconfined-rectangular-aquifer-with-pumping-unsteady-flow">
     Homebrew - Example 8: Unconfined Rectangular Aquifer with Pumping – Unsteady Flow
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="transient-groundwater-models">
<h1>Transient Groundwater Models<a class="headerlink" href="#transient-groundwater-models" title="Permalink to this headline">¶</a></h1>
<p>Transient (non-equilibrium) models use the same differencing approach, but the time derivative is no longer zero, so the iterative solution occurs within individual time steps.</p>
<div class="section" id="confined-aquifers">
<h2>Confined Aquifers<a class="headerlink" href="#confined-aquifers" title="Permalink to this headline">¶</a></h2>
<p>Starting with</p>
<div class="math notranslate nohighlight">
\[
S \frac{\partial h}{\partial t} = 
\frac{\partial}{\partial x}({T_x \frac{\partial h}{\partial x}}) +
\frac{\partial}{\partial y}({T_y \frac{\partial h}{\partial y}}) + R - Q
\]</div>
<p>the right hand side is approximated first</p>
<div class="math notranslate nohighlight">
\[ 
S \frac{\partial h_{i,j}}{\partial t} = [ \frac{1}{\Delta x} T_x \frac{h_{i−1,j} − h_{i,j}}{\Delta x} + \frac{1}{\Delta y} T_y \frac{h_{i,j-1} − h_{i,j}}{\Delta y}]-[\frac{1}{\Delta x} T_x \frac{h_{i,j} − h_{i+1,j}}{\Delta x} + \frac{1}{\Delta y} T_y \frac{h_{i,j} − h_{i,j+1}}{\Delta y}] + \frac{R_{i,j}}{\Delta x \Delta y} - \frac{Q_{i,j}}{\Delta x \Delta y}
\]</div>
<p>then the left hand side is approximated by a first-order difference in time as</p>
<div class="math notranslate nohighlight">
\[
S \frac{\partial h_{i,j}}{\partial t} ~\approx S \frac{h^{t+\Delta t}_{i,j} - h^{t}_{i,j}}{\Delta t}
\]</div>
<p>Substitute to obtain</p>
<div class="math notranslate nohighlight">
\[ 
S \frac{h^{t+\Delta t}_{i,j} - h^{t}_{i,j}}{\Delta t} = [ \frac{1}{\Delta x} T_x \frac{h_{i−1,j} − h_{i,j}}{\Delta x} + \frac{1}{\Delta y} T_y \frac{h_{i,j-1} − h_{i,j}}{\Delta y}]-[\frac{1}{\Delta x} T_x \frac{h_{i,j} − h_{i+1,j}}{\Delta x} + \frac{1}{\Delta y} T_y \frac{h_{i,j} − h_{i,j+1}}{\Delta y}] + \frac{R_{i,j}}{\Delta x \Delta y} - \frac{Q_{i,j}}{\Delta x \Delta y}
\]</div>
<p>Isolate the update term and we have an <strong>explicit</strong> method, which is easy to program, but unstable if <span class="math notranslate nohighlight">\(\Delta t\)</span> is too large.</p>
<div class="math notranslate nohighlight">
\[ 
h^{t+\Delta t}_{i,j} = h^{t}_{i,j} + [ \frac{\Delta t}{S \Delta x} T_x \frac{h^{t}_{i−1,j} − h^{t}_{i,j}}{\Delta x} + \frac{\Delta t}{S \Delta y} T_y \frac{h^{t}_{i,j-1} − h^{t}_{i,j}}{\Delta y}]-[\frac{\Delta t}{S \Delta x} T_x \frac{h^{t}_{i,j} − h^{t}_{i+1,j}}{\Delta x} + \frac{\Delta t}{S \Delta y} T_y \frac{h^{t}_{i,j} − h^{t}_{i,j+1}}{\Delta y}] + \frac{\Delta t R_{i,j}}{S \Delta x \Delta y} - \frac{\Delta t Q_{i,j}}{S \Delta x \Delta y}
\]</div>
<p>An <strong>implicit</strong> method that is unconditionally stable and can use our already built iterative tools is</p>
<div class="math notranslate nohighlight">
\[ 
h^{t+\Delta t}_{i,j} = h^{t}_{i,j} + [ \frac{\Delta t}{S \Delta x} T_x \frac{h^{\Delta t}_{i−1,j} − h^{\Delta t}_{i,j}}{\Delta x} + \frac{\Delta t}{S \Delta y} T_y \frac{h^{\Delta t}_{i,j-1} − h^{\Delta t}_{i,j}}{\Delta y}]-[\frac{\Delta t}{S \Delta x} T_x \frac{h^{\Delta t}_{i,j} − h^{\Delta t}_{i+1,j}}{\Delta x} + \frac{\Delta t}{S \Delta y} T_y \frac{h^{\Delta t}_{i,j} − h^{\Delta t}_{i,j+1}}{\Delta y}] + \frac{\Delta t R^{t}_{i,j}}{S \Delta x \Delta y} - \frac{\Delta t Q^{t}_{i,j}}{S \Delta x \Delta y}
\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While the implicit method is unconditionally stable, its accuracy is dependent on the ratios of time steps and space steps and may still need to employ short time steps to obtain a meaningful result</p>
</div>
<p>Observe a very important part of the difference equation, <span class="math notranslate nohighlight">\(h^t_{i,j}\)</span>
is known at the beginning of a time step and does not change during the computation effort for that time period – it is just another constant like recharge or pumping. However, once we have the
update, then it is changed and the next time step is begun. The observation is
important to remember because we are simply going to wrap a time stepping loop
around our already tested and working Jacobi solver.</p>
<p>Employing the same <span class="math notranslate nohighlight">\(A, B, C, D\)</span> structure as the unsteady 2D solvers we built the
update model is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A_{i,j} = \frac{\Delta t}{2 S_{i,j}∆x^2} (T_{x,(i−1,j)}  + T_{x,(i,j)} )\\
B_{i,j} = \frac{\Delta t}{2 S_{i,j}∆x^2} (T_{x,(i,j)}  + T_{x,(i+1,j)} )\\
C_{i,j} = \frac{\Delta t}{2 S_{i,j}∆y^2} (T_{y,(i,j−1)}  + T_{y,(i,j)} )\\
D_{i,j} = \frac{\Delta t}{2 S_{i,j}∆y^2} (T_{y,(i,j)}  + T_{y,(i,j+1)} )\\
E_{i,j} = \frac{\Delta t}{2 S_{i,j}∆y^2}
\end{split}\]</div>
<p>The last term <span class="math notranslate nohighlight">\(E\)</span> is for the pumping term</p>
<p>The difference equation after substitution</p>
<div class="math notranslate nohighlight">
\[
h^{t+\Delta t}_{i,j} = \frac{[A_{i,j} h^{t+\Delta t}_{i−1,j} + B_{i,j} h^{t+\Delta t}_{i+1,j} + C_{i,j} h^{t+\Delta t}_{i,j−1} + D_{i,j} h^{t+\Delta t}_{i,j+1}]+ h^{t}_{i,j} + E_{i,j}[R^{t}_{i,j} - Q^{t}_{i,j}]}{[A_{i,j} + B_{i,j} + C_{i,j} + D_{i,j} + 1]} 
\]</div>
<p>This equation is quite amenable to the Jacobi iteration technique, with the addition
of the two right-most terms for head at the start of the time step and the net recharge
less pumping.
Notice the +1 in the denominator of the weighting term – it reflects
that <span class="math notranslate nohighlight">\(h^{t+∆t}_{i,j}\)</span> appears on both the left and right hand side of the equation.
Listing 71 is an R script that implements these changes. In the script the plotting
has been moved into the prototype function, so we can generate a plot when we wish.
The input data reading portion has a line added to capture the time step length,
the maximum number of time steps to take, a printing frequency (make a plot every
iprint time steps), and a storage coefficient array. Observe that the printing test
makes use of the MODULO construct in R.</p>
<div class="section" id="homebrew-example-7-rectangular-aquifer-with-pumping-unsteady-flow">
<h3>Homebrew - Example 7: Rectangular Aquifer with Pumping – Unsteady Flow<a class="headerlink" href="#homebrew-example-7-rectangular-aquifer-with-pumping-unsteady-flow" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="#hubbleville"><span class="std std-numref">Fig. 26</span></a> is a plan view of a confined aquifer with a well field located as shown, near the Red River.</p>
<div class="figure align-default" id="hubbleville">
<a class="reference internal image-reference" href="../../_images/hubbleville.png"><img alt="../../_images/hubbleville.png" src="../../_images/hubbleville.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 26 </span><span class="caption-text">Plan view schematic of Hubbleville aquifer system.</span><a class="headerlink" href="#hubbleville" title="Permalink to this image">¶</a></p>
</div>
<p>The head in the river is 1000 meters as is the head at the South boundary, the
Green Swamp. The aquifer thickness is about <span class="math notranslate nohighlight">\(10\)</span> meters. The hydraulic conductivity
of the water producing zone is <span class="math notranslate nohighlight">\(20\)</span> meters per day. Determine the head distribution
every 1/2 year of pumping at a rate of <span class="math notranslate nohighlight">\(20,000\)</span> cubic meters per day for 3 years.
The storage coefficient of the aquifer is <span class="math notranslate nohighlight">\(S = 0.01\)</span>.</p>
<p><strong>input7.txt</strong> Input file for the Hubbleville Aquifer Example. Annotations in the listing need to be re-
moved for actual running of the file and are included to illustrate the various parts of the input data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1000</span> <span class="o">&lt;==</span> <span class="n">Delta</span> <span class="n">x</span>
<span class="mi">1000</span> <span class="o">&lt;==</span> <span class="n">Delta</span> <span class="n">y</span>
<span class="mi">10</span> <span class="o">&lt;==</span> <span class="n">Delta</span> <span class="n">z</span> <span class="p">(</span> <span class="n">thickness</span> <span class="p">)</span>
<span class="mf">0.1</span> <span class="o">&lt;==</span> <span class="n">Time</span> <span class="n">step</span> <span class="n">length</span> <span class="p">(</span> <span class="ow">in</span> <span class="n">days</span> <span class="p">)</span>
<span class="mi">10</span> <span class="o">&lt;==</span> <span class="n">row</span> <span class="n">count</span>
<span class="mi">10</span> <span class="o">&lt;==</span> <span class="n">column</span> <span class="n">count</span>
<span class="mf">1e-4</span> <span class="o">&lt;==</span> <span class="n">tolerance</span> <span class="k">for</span> <span class="n">linear</span> <span class="n">solver</span>
<span class="mi">100</span> <span class="o">&lt;==</span> <span class="n">how</span> <span class="n">many</span> <span class="n">trials</span> <span class="n">per</span> <span class="n">linear</span> <span class="n">system</span>
<span class="mi">10950</span> <span class="o">&lt;==</span> <span class="n">how</span> <span class="n">many</span> <span class="n">time</span> <span class="n">steps</span>
<span class="mi">1825</span> <span class="o">&lt;==</span> <span class="nb">print</span> <span class="n">every</span> <span class="c1">## time step</span>
<span class="mi">0</span> <span class="mi">1000</span> <span class="mi">2000</span> <span class="mi">3000</span> <span class="mi">4000</span> <span class="mi">5000</span> <span class="mi">6000</span> <span class="mi">7000</span> <span class="mi">8000</span> <span class="mi">9000</span>
<span class="mi">0</span> <span class="mi">1000</span> <span class="mi">2000</span> <span class="mi">3000</span> <span class="mi">4000</span> <span class="mi">5000</span> <span class="mi">6000</span> <span class="mi">7000</span> <span class="mi">8000</span> <span class="mi">9000</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="o">&lt;==</span> <span class="n">boundary</span> <span class="n">conditions</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="o">&lt;==</span> <span class="n">initial</span> <span class="n">head</span> <span class="n">array</span>
<span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span>
<span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span>
<span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span>
<span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span>
<span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span>
<span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span>
<span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span>
<span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span>
<span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span> <span class="mi">1000</span>
<span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="o">&lt;==</span> <span class="n">Kx</span> <span class="n">array</span>
<span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span>
<span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span>
<span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span>
<span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span>
<span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span>
<span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span>
<span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span>
<span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span>
<span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span>
<span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="o">&lt;==</span> <span class="n">Ky</span> <span class="n">array</span>
<span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span>
<span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span>
<span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span>
<span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span>
<span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span>
<span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span>
<span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span>
<span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span>
<span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span>
<span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="o">&lt;==</span> <span class="n">Storage</span> <span class="n">coefficient</span>
<span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span>
<span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span>
<span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span>
<span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span>
<span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span>
<span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span>
<span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span>
<span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span>
<span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.01</span> <span class="mf">0.11</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="o">&lt;==</span> <span class="n">pumping</span> <span class="n">array</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">20000</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">reset</span> -f

<span class="k">def</span> <span class="nf">sse</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">sse</span><span class="o">=</span><span class="mf">0.0</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">sse</span><span class="o">=</span><span class="n">sse</span><span class="o">+</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">-</span><span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span><span class="p">(</span><span class="n">sse</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="c1">##print(nr,nc)</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="c1">##print(ir,jc)</span>
            <span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">=</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span>
    <span class="k">return</span><span class="p">(</span><span class="n">matrix2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">writearray</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="n">new_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">),</span> <span class="mi">0</span><span class="p">))</span>    
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">new_list</span><span class="p">[</span><span class="n">ir</span><span class="p">][:])</span>
    <span class="k">return</span><span class="p">()</span>
<span class="kn">import</span> <span class="nn">numpy</span> 
<span class="n">localfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;input7.txt&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="c1"># connect and read file for 2D gw model</span>
<span class="n">deltax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltay</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltaz</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltat</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span> <span class="c1"># time step</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">tolerance</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">maxiter</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span> <span class="c1"># max iter per time step</span>
<span class="n">maxtime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span> <span class="c1"># total time steps</span>
<span class="n">iprint</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span> <span class="c1"># output every iprint steps</span>
<span class="n">distancex</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancex</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">distancey</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancey</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarytop</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarytop</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarybottom</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarybottom</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryleft</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryleft</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryright</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryright</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">head</span> <span class="o">=</span><span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">head</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1">#writearray(head)</span>
<span class="n">hydcondx</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondx</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1">#writearray(hydcondx)</span>
<span class="n">hydcondy</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondy</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1">#writearray(hydcondy)</span>
<span class="n">storage</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">storage</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1">#writearray(storage)</span>
<span class="n">pumping</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">pumping</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1">#writearray(pumping)</span>
<span class="n">localfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="c1"># Disconnect the file</span>
<span class="c1">##</span>
<span class="n">amat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">bmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">cmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">dmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">qrat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="c1">## Transmissivity Arrays</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltat</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">storage</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltat</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">storage</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltat</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">storage</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">deltat</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">storage</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">## Net Pumping Array</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="n">qrat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">deltat</span><span class="o">*</span><span class="n">pumping</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">])</span> <span class="o">/</span><span class="p">(</span><span class="n">deltax</span><span class="o">*</span><span class="n">deltay</span><span class="o">*</span><span class="n">storage</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">])</span>
<span class="c1">## Headold array initialize</span>
<span class="n">headold</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span> <span class="c1">#force a new matrix</span>
<span class="n">headnew</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span> <span class="c1">#force a new matrix</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span> <span class="c1"># element-by-element assignment</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="n">headold</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span>
        <span class="n">headnew</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">head</span><span class="p">)),</span><span class="nb">hex</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">headold</span><span class="p">)))</span> <span class="c1"># check that memory is different addresses</span>

<span class="c1">## Time Stepping Outer Loop</span>
<span class="k">for</span> <span class="n">itime</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxtime</span><span class="p">):</span>

<span class="c1">#### Single Time Step Update Loop</span>
    <span class="n">tolflag</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxiter</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
                <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="n">headnew</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span>
<span class="c1"># Boundary Conditions</span>

<span class="c1"># first and last row special == no flow boundaries</span>
        <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">boundarytop</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at top</span>
                <span class="n">head</span> <span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
            <span class="k">if</span> <span class="n">boundarybottom</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">jcol</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at bottom</span>
                <span class="n">head</span> <span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
<span class="c1"># first and last column special == no flow boundaries     </span>
        <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span> 
            <span class="k">if</span>  <span class="n">boundaryleft</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># no - flow at left</span>
            <span class="k">if</span> <span class="n">boundaryright</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
                <span class="n">head</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span> <span class="n">irow</span> <span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># no - flow at right</span>
<span class="c1"># interior updates</span>
        <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span> <span class="p">(</span><span class="n">headold</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">+</span> <span class="n">qrat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> 
                                   <span class="o">+</span><span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span>
                                   <span class="o">+</span><span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                                   <span class="o">+</span><span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
                                   <span class="o">+</span><span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">amat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">bmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">cmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">dmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">+</span><span class="mf">1.0</span><span class="p">)</span>

<span class="c1"># test for stopping iterations</span>
        <span class="n">percentdiff</span> <span class="o">=</span> <span class="n">sse</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headnew</span><span class="p">)</span>
        <span class="k">if</span>  <span class="n">percentdiff</span> <span class="o">&lt;=</span> <span class="n">tolerance</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
                <span class="n">headnew</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span>
<span class="c1">### End Single Step Update Loop</span>
<span class="c1"># update values at end of time step</span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
            <span class="n">headold</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">itime</span> <span class="o">%</span> <span class="n">iprint</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elapsed Time &quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">deltat</span><span class="o">*</span><span class="p">(</span><span class="n">itime</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">),</span><span class="s2">&quot; days&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Closure Error = &quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">percentdiff</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations Last Step =&quot;</span><span class="p">,</span><span class="n">iteration</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pumping</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Minimum Head&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span><span class="mi">3</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pumpage Total&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">deltat</span><span class="o">*</span><span class="p">(</span><span class="n">itime</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">p</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span><span class="mi">3</span><span class="p">),</span><span class="s2">&quot; cubic meters&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Head End of Timestep </span><span class="se">\n</span><span class="s2"> ----&quot;</span><span class="p">)</span>
        <span class="n">writearray</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--------</span><span class="se">\n</span><span class="s2">--------&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">head</span><span class="p">)),</span><span class="nb">hex</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">headold</span><span class="p">)))</span>
        <span class="n">my_xyz</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
        <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
                <span class="n">my_xyz</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">distancex</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">],</span><span class="n">distancey</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">irow</span><span class="p">],</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]])</span>
        <span class="kn">import</span> <span class="nn">pandas</span>
        <span class="n">my_xyz</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">my_xyz</span><span class="p">)</span> <span class="c1"># convert into a data frame</span>
<span class="c1">#print(my_xyz) # activate to examine the dataframe</span>
        <span class="kn">import</span> <span class="nn">numpy</span> 
        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span>
        <span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>
<span class="c1"># extract lists from the dataframe</span>
        <span class="n">coord_x</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 0 of dataframe</span>
        <span class="n">coord_y</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 1 of dataframe</span>
        <span class="n">coord_z</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 2 of dataframe</span>
        <span class="n">coord_xy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">coord_x</span><span class="p">,</span> <span class="n">coord_y</span><span class="p">))</span>
<span class="c1"># Set plotting range in original data units</span>
        <span class="n">lon</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="mi">300</span><span class="p">)</span>
        <span class="n">lat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="mi">80</span><span class="p">)</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
<span class="c1"># Grid the data; use linear interpolation (choices are nearest, linear, cubic)</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_xy</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_z</span><span class="p">),</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="c1"># Build the map</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
        <span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="mi">9</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Head Map at Elapsed Time &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">deltat</span><span class="o">*</span><span class="p">(</span><span class="n">itime</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39; days&#39;</span><span class="p">)</span>
<span class="c1">## End Time Stepping Outer Loop</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;End Simulation&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0xffff7c061b80 0xffff74eed180
Elapsed Time  0.1  days
Closure Error =  3.09976e-07
Iterations Last Step = 1
Minimum Head 999.802
Pumpage Total 2000.0  cubic meters
Head End of Timestep 
 ----
0 [1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000.]
1 [1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000.]
2 [1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000.]
3 [1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000.]
4 [1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000.]
5 [1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000.]
6 [1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000.]
7 [1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000.]
8 [1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000.]
9 [1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000.]
--------
--------
0xffff7c061b80 0xffff74eed180
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time  182.1  days
Closure Error =  0.000394493645
Iterations Last Step = 0
Minimum Head 959.302
Pumpage Total 3642000.0  cubic meters
Head End of Timestep 
 ----
0 [1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000.]
1 [1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000.]
2 [1000. 1000. 1000.  999.  999.  999. 1000. 1000. 1000. 1000.]
3 [ 999.  999.  999.  999.  998.  999.  999.  999. 1000. 1000.]
4 [998. 998. 998. 997. 996. 997. 998. 999. 999. 999.]
5 [997. 997. 996. 994. 992. 994. 996. 998. 999. 999.]
6 [996. 996. 994. 989. 983. 989. 994. 997. 998. 998.]
7 [996. 996. 992. 983. 959. 984. 993. 997. 998. 998.]
8 [997. 997. 996. 991. 986. 992. 996. 998. 999. 999.]
9 [1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000.]
--------
--------
0xffff7c061b80 0xffff74eed180
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time  364.1  days
Closure Error =  0.000308454755
Iterations Last Step = 1
Minimum Head 955.806
Pumpage Total 7282000.0  cubic meters
Head End of Timestep 
 ----
0 [1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000.]
1 [999. 999. 999. 999. 999. 999. 999. 999. 999. 999.]
2 [998. 998. 998. 998. 998. 998. 998. 999. 999. 999.]
3 [997. 997. 997. 996. 996. 996. 997. 998. 998. 998.]
4 [995. 995. 995. 994. 993. 994. 995. 996. 997. 997.]
5 [993. 993. 992. 990. 988. 990. 993. 995. 996. 996.]
6 [992. 992. 990. 985. 979. 985. 991. 994. 996. 996.]
7 [992. 992. 989. 980. 956. 980. 990. 994. 996. 996.]
8 [995. 995. 994. 989. 984. 990. 994. 997. 998. 998.]
9 [1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000.]
--------
--------
0xffff7c061b80 0xffff74eed180
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time  546.1  days
Closure Error =  0.000340195044
Iterations Last Step = 0
Minimum Head 954.199
Pumpage Total 10922000.0  cubic meters
Head End of Timestep 
 ----
0 [1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000.]
1 [998. 998. 998. 998. 998. 999. 999. 999. 999. 999.]
2 [997. 997. 997. 997. 997. 997. 997. 997. 998. 998.]
3 [995. 995. 995. 994. 994. 995. 995. 996. 996. 996.]
4 [993. 993. 992. 991. 991. 992. 993. 995. 995. 995.]
5 [991. 991. 990. 988. 986. 988. 991. 993. 994. 994.]
6 [990. 990. 987. 983. 977. 983. 989. 992. 994. 994.]
7 [991. 991. 987. 978. 954. 979. 989. 993. 995. 995.]
8 [995. 995. 993. 988. 983. 989. 993. 996. 997. 997.]
9 [1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000.]
--------
--------
0xffff7c061b80 0xffff74eed180
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time  728.1  days
Closure Error =  0.000218023617
Iterations Last Step = 1
Minimum Head 953.256
Pumpage Total 14562000.0  cubic meters
Head End of Timestep 
 ----
0 [1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000.]
1 [998. 998. 998. 998. 998. 998. 998. 998. 998. 998.]
2 [996. 996. 996. 996. 996. 996. 996. 997. 997. 997.]
3 [994. 994. 993. 993. 993. 993. 994. 995. 995. 995.]
4 [991. 991. 991. 990. 990. 991. 992. 993. 994. 994.]
5 [990. 990. 988. 986. 984. 987. 990. 992. 993. 993.]
6 [989. 989. 986. 981. 975. 982. 988. 991. 993. 993.]
7 [990. 990. 986. 977. 953. 978. 988. 992. 994. 994.]
8 [994. 994. 992. 988. 982. 988. 993. 995. 996. 996.]
9 [1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000.]
--------
--------
0xffff7c061b80 0xffff74eed180
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time  910.1  days
Closure Error =  0.000489030327
Iterations Last Step = 0
Minimum Head 952.665
Pumpage Total 18202000.0  cubic meters
Head End of Timestep 
 ----
0 [1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000.]
1 [998. 998. 998. 998. 998. 998. 998. 998. 998. 998.]
2 [995. 995. 995. 995. 995. 995. 996. 996. 996. 996.]
3 [993. 993. 993. 992. 992. 993. 993. 994. 995. 995.]
4 [991. 991. 990. 989. 989. 990. 991. 992. 993. 993.]
5 [989. 989. 987. 985. 984. 986. 989. 991. 992. 992.]
6 [988. 988. 985. 980. 975. 981. 987. 990. 992. 992.]
7 [989. 989. 986. 977. 953. 977. 987. 991. 993. 993.]
8 [994. 994. 992. 988. 982. 988. 993. 995. 996. 996.]
9 [1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000.]
--------
--------
0xffff7c061b80 0xffff74eed180
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time  1092.1  days
Closure Error =  0.00089839574
Iterations Last Step = 0
Minimum Head 952.288
Pumpage Total 21842000.0  cubic meters
Head End of Timestep 
 ----
0 [1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000.]
1 [997. 997. 997. 997. 997. 998. 998. 998. 998. 998.]
2 [995. 995. 995. 995. 995. 995. 995. 996. 996. 996.]
3 [992. 992. 992. 992. 992. 992. 993. 994. 994. 994.]
4 [990. 990. 989. 989. 988. 989. 991. 992. 992. 992.]
5 [988. 988. 987. 985. 983. 985. 988. 990. 991. 991.]
6 [987. 987. 985. 980. 974. 981. 986. 990. 991. 991.]
7 [989. 989. 985. 976. 952. 977. 987. 991. 993. 993.]
8 [993. 993. 992. 987. 982. 988. 992. 995. 996. 996.]
9 [1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000. 1000.]
--------
--------
0xffff7c061b80 0xffff74eed180
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>End Simulation
</pre></div>
</div>
<img alt="../../_images/14gwmodels_3_8.png" src="../../_images/14gwmodels_3_8.png" />
<img alt="../../_images/14gwmodels_3_9.png" src="../../_images/14gwmodels_3_9.png" />
<img alt="../../_images/14gwmodels_3_10.png" src="../../_images/14gwmodels_3_10.png" />
<img alt="../../_images/14gwmodels_3_11.png" src="../../_images/14gwmodels_3_11.png" />
<img alt="../../_images/14gwmodels_3_12.png" src="../../_images/14gwmodels_3_12.png" />
<img alt="../../_images/14gwmodels_3_13.png" src="../../_images/14gwmodels_3_13.png" />
<img alt="../../_images/14gwmodels_3_14.png" src="../../_images/14gwmodels_3_14.png" />
</div>
</div>
<p>The contour maps are plots of the head distribution every 182 days.
In the plots one can observe that the cone
of depression is growing (outward from the well field), and the numerical values of
the contours are reflecting the progressively declining head elevations (at least in the first 100 days).
At some point the head distribution would stop changing (and equilibrium solution)
and would agree with a steady flow simulation for the same aquifer conditions. In this example equilibrium is reached in the first 100 days.
If one were to perform a “cut-and-fill” analysis of the contour maps, the amount of aquifer
dewatered (difference in head multiplied by the storage coefficient, integrated over
the entire area shown) would equal the volume pumped from the system, during the transient portion of behavior.</p>
<p>The next section will extend the concept to an unconfied aquifer – again using the
variable transmissivity approach of the prior chapter.</p>
</div>
</div>
<div class="section" id="unconfined-aquifers">
<h2>Unconfined Aquifers<a class="headerlink" href="#unconfined-aquifers" title="Permalink to this headline">¶</a></h2>
<p>Using the variable transmissivity ….</p>
<div class="section" id="homebrew-example-8-unconfined-rectangular-aquifer-with-pumping-unsteady-flow">
<h3>Homebrew - Example 8: Unconfined Rectangular Aquifer with Pumping – Unsteady Flow<a class="headerlink" href="#homebrew-example-8-unconfined-rectangular-aquifer-with-pumping-unsteady-flow" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="#greenswamp"><span class="std std-numref">Fig. 27</span></a> is a plan view of an unconfined aquifer with a Well field located as shown,
near the Red River.</p>
<div class="figure align-default" id="greenswamp">
<a class="reference internal image-reference" href="../../_images/greenswamp.png"><img alt="../../_images/greenswamp.png" src="../../_images/greenswamp.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 27 </span><span class="caption-text">Plan view schematic of Green Swamp/Hubbleville aquifer system.</span><a class="headerlink" href="#greenswamp" title="Permalink to this image">¶</a></p>
</div>
<p>The head in the river is 1000 meters as is the head at the South boundary, the Green Swamp. The well field pumps 20,000 cubic meters per day. The net recharge to the aquifer is 0.01 meters/day. The hydraulic conductivity of the aquifer is 50 meters per day. The hydraulic conductivity of the swamp is about 500 meters per day. The specific yield of the aquifer is 0.35. The town of Hubbleville is at elevation 1020 meters. The managers of the Green Swamp Conservation area are concerned that pumping will significantly reduce groundwater discharge to the swamp and threaten wildlife habitat. The town claims that the well is located sufficiently close to the Red River so that induced recharge will contribute the significant portion of water that flows to the well and none will come from the swamp. Each cell in the sketch is 1000 X 1000 meters.</p>
<p>Use an unsteady, unconfined groundwater flow script to</p>
<ol class="simple">
<li><p>Demonstrate that flow is towards the swamp with the well field inactive (zero pumping, but non-zero recharge).</p></li>
<li><p>Determine if the flow is still towards the swamp with the well field activated (non-zero pumping, non-zero recharge).</p></li>
<li><p>Assuming that water is eventually drawn from the swamp, determine how many years the well field can be operated, before water is drawn from the swamp into the well, or until the well de-waters (head drops below zero).</p></li>
</ol>
<p>Answering these three questions is a matter of running our script three times, with two input files. The first input file would be the problem conditions with the well off, but with recharge on. Given that our prototype script does not have a recharge array, we have two choices — add one and refactor the requesite parts of the script, or observe that recharge is just negative pumping and simply change the pumping array.</p>
<p>So the recharge for any cell in the correct problem units is</p>
<p><span class="math notranslate nohighlight">\(R_{i,j} = rate \times ∆x \times ∆y = 0.01 m/day \times 1000 m \times 1000 m = 10000 m^3/day\)</span></p>
<p>The first question is asking about a “pre-development” condition, so we need to run our script once until the solution stops changing (an equilibrium solution) then use the head distribution for this solution as the initial condition for the second run, when we turn on the pump. An important observation is that the aquifer bottom elevation is at 980 meters, so the hydraulic head in the swamp or at the river is only 20 meters based on the profile sketch. Thus the maximum head in the aquifer should be less than 1020 meters (otherwise the whole area is a swamp) and greater that zero. Once the computations are completed we can add back the datum (980 meters) to recover the various water elevations if we wish. For the example, we will just stipulate the desired head is between zero and 40 meters.</p>
<p><strong>input8.txt</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1000</span>
<span class="mi">1000</span>
<span class="mi">10</span>
<span class="mi">1</span>
<span class="mi">10</span>
<span class="mi">10</span>
<span class="mf">1e-4</span>
<span class="mi">100</span>
<span class="mi">10950</span>
<span class="mi">1825</span>
<span class="mi">0</span> <span class="mi">1000</span> <span class="mi">2000</span> <span class="mi">3000</span> <span class="mi">4000</span> <span class="mi">5000</span> <span class="mi">6000</span> <span class="mi">7000</span> <span class="mi">8000</span> <span class="mi">9000</span>
<span class="mi">0</span> <span class="mi">1000</span> <span class="mi">2000</span> <span class="mi">3000</span> <span class="mi">4000</span> <span class="mi">5000</span> <span class="mi">6000</span> <span class="mi">7000</span> <span class="mi">8000</span> <span class="mi">9000</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span>
<span class="mf">21.33491</span> <span class="mf">21.33491</span> <span class="mf">21.33491</span> <span class="mf">21.33491</span> <span class="mf">21.33491</span> <span class="mf">21.33491</span> <span class="mf">21.33491</span> <span class="mf">21.33491</span> <span class="mf">21.33491</span> <span class="mf">21.33491</span>
<span class="mf">23.18453</span> <span class="mf">23.18453</span> <span class="mf">23.18453</span> <span class="mf">23.18453</span> <span class="mf">23.18453</span> <span class="mf">23.18453</span> <span class="mf">23.18453</span> <span class="mf">23.18453</span> <span class="mf">23.18453</span> <span class="mf">23.18453</span>
<span class="mf">29.33826</span> <span class="mf">29.33826</span> <span class="mf">29.33826</span> <span class="mf">29.33826</span> <span class="mf">29.33826</span> <span class="mf">29.33826</span> <span class="mf">29.33826</span> <span class="mf">29.33826</span> <span class="mf">29.33826</span> <span class="mf">29.33826</span>
<span class="mf">32.70564</span> <span class="mf">32.70564</span> <span class="mf">32.70564</span> <span class="mf">32.70564</span> <span class="mf">32.70564</span> <span class="mf">32.70564</span> <span class="mf">32.70564</span> <span class="mf">32.70564</span> <span class="mf">32.70564</span> <span class="mf">32.70564</span>
<span class="mf">34.12182</span> <span class="mf">34.12182</span> <span class="mf">34.12182</span> <span class="mf">34.12182</span> <span class="mf">34.12182</span> <span class="mf">34.12182</span> <span class="mf">34.12182</span> <span class="mf">34.12182</span> <span class="mf">34.12182</span> <span class="mf">34.12182</span>
<span class="mf">33.83271</span> <span class="mf">33.83271</span> <span class="mf">33.83271</span> <span class="mf">33.83271</span> <span class="mf">33.83271</span> <span class="mf">33.83271</span> <span class="mf">33.83271</span> <span class="mf">33.83271</span> <span class="mf">33.83271</span> <span class="mf">33.83271</span>
<span class="mf">31.79183</span> <span class="mf">31.79183</span> <span class="mf">31.79183</span> <span class="mf">31.79183</span> <span class="mf">31.79183</span> <span class="mf">31.79183</span> <span class="mf">31.79183</span> <span class="mf">31.79183</span> <span class="mf">31.79183</span> <span class="mf">31.79183</span>
<span class="mf">27.61346</span> <span class="mf">27.61346</span> <span class="mf">27.61346</span> <span class="mf">27.61346</span> <span class="mf">27.61346</span> <span class="mf">27.61346</span> <span class="mf">27.61346</span> <span class="mf">27.61346</span> <span class="mf">27.61346</span> <span class="mf">27.61346</span>
<span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span>
<span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span>
<span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span>
<span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span>
<span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span>
<span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span>
<span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span>
<span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span>
<span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span>
<span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span>
<span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span>
<span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span>
<span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span> <span class="mi">500</span>
<span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span>
<span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span>
<span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span>
<span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span>
<span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span>
<span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span>
<span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span>
<span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span>
<span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span>
<span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span>
<span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span>
<span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span>
<span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span>
<span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span>
<span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span>
<span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span>
<span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span>
<span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span> <span class="mf">0.35</span>
<span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span>
<span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span>
<span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span>
<span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span>
<span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span>
<span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span>
<span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span>
<span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span>
<span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span>
<span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span> <span class="o">-</span><span class="mi">10000</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">reset</span> -f

<span class="k">def</span> <span class="nf">sse</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">sse</span><span class="o">=</span><span class="mf">0.0</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">sse</span><span class="o">=</span><span class="n">sse</span><span class="o">+</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">-</span><span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span><span class="p">(</span><span class="n">sse</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="c1">##print(nr,nc)</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="c1">##print(ir,jc)</span>
            <span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">=</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span>
    <span class="k">return</span><span class="p">(</span><span class="n">matrix2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">writearray</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="n">new_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">),</span> <span class="mi">0</span><span class="p">))</span>    
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">new_list</span><span class="p">[</span><span class="n">ir</span><span class="p">][:])</span>
    <span class="k">return</span><span class="p">()</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="n">localfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;input8.txt&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="c1"># connect and read file for 2D gw model</span>
<span class="n">deltax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltay</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltaz</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltat</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span> <span class="c1"># time step</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">tolerance</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">maxiter</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span> <span class="c1"># max iter per time step</span>
<span class="n">maxtime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span> <span class="c1"># total time steps</span>
<span class="n">iprint</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span> <span class="c1"># output every iprint steps</span>
<span class="n">distancex</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancex</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">distancey</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancey</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarytop</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarytop</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarybottom</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarybottom</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryleft</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryleft</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryright</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryright</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">head</span> <span class="o">=</span><span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">head</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1">#writearray(head)</span>
<span class="n">hydcondx</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondx</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1">#writearray(hydcondx)</span>
<span class="n">hydcondy</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondy</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1">#writearray(hydcondy)</span>
<span class="n">storage</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">storage</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1">#writearray(storage)</span>
<span class="n">pumping</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">pumping</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1">#writearray(pumping)</span>
<span class="n">localfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="c1"># Disconnect the file</span>
<span class="c1">##</span>
<span class="n">amat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">bmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">cmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">dmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">qrat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="c1">## Net Pumping Array</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="n">qrat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">deltat</span><span class="o">*</span><span class="n">pumping</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">])</span> <span class="o">/</span><span class="p">(</span><span class="n">deltax</span><span class="o">*</span><span class="n">deltay</span><span class="o">*</span><span class="n">storage</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">])</span>
<span class="c1">## Headold array initialize</span>
<span class="n">headold</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span> <span class="c1">#force a new matrix</span>
<span class="n">headnew</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span> <span class="c1"># element-by-element assignment</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="n">headold</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span>
        <span class="n">headnew</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">head</span><span class="p">)),</span><span class="nb">hex</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">headold</span><span class="p">)),</span><span class="nb">hex</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">headnew</span><span class="p">)))</span>

<span class="c1">## Time Stepping Outer Loop</span>
<span class="k">for</span> <span class="n">itime</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxtime</span><span class="p">):</span>

<span class="c1">#### Single Time Step Update Loop</span>
    <span class="n">tolflag</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxiter</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
                <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="n">headnew</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span>
<span class="c1"># Boundary Conditions</span>
<span class="c1">## Transmissivity Arrays</span>
        <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> <span class="o">*</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> <span class="o">*</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> <span class="o">*</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> <span class="o">*</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span> <span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> <span class="o">*</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> <span class="o">*</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Boundary Conditions</span>
<span class="c1"># first and last row special == no flow boundaries</span>
        <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">boundarytop</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at top</span>
                <span class="n">head</span> <span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
            <span class="k">if</span> <span class="n">boundarybottom</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">jcol</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at bottom</span>
                <span class="n">head</span> <span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
<span class="c1"># first and last column special == no flow boundaries     </span>
        <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span> 
            <span class="k">if</span>  <span class="n">boundaryleft</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># no - flow at left</span>
            <span class="k">if</span> <span class="n">boundaryright</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
                <span class="n">head</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span> <span class="n">irow</span> <span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># no - flow at right</span>
<span class="c1"># interior updates</span>
        <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span> <span class="p">(</span><span class="n">headold</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">+</span> <span class="n">qrat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> 
                                   <span class="o">+</span><span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span>
                                   <span class="o">+</span><span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                                   <span class="o">+</span><span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
                                   <span class="o">+</span><span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">amat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">bmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">cmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">dmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">+</span><span class="mf">1.0</span><span class="p">)</span>

<span class="c1"># test for stopping iterations</span>
        <span class="n">percentdiff</span> <span class="o">=</span> <span class="n">sse</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headnew</span><span class="p">)</span>
        <span class="k">if</span>  <span class="n">percentdiff</span> <span class="o">&lt;=</span> <span class="n">tolerance</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
                <span class="n">headnew</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span>
<span class="c1">### End Single Step Update Loop</span>
<span class="c1"># update values at end of a time step</span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
            <span class="n">headold</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">itime</span> <span class="o">%</span> <span class="n">iprint</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elapsed Time &quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">deltat</span><span class="o">*</span><span class="p">(</span><span class="n">itime</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">),</span><span class="s2">&quot; days&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Closure Error = &quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">percentdiff</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pumping</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Minimum Head&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span><span class="mi">3</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pumpage Total&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">deltat</span><span class="o">*</span><span class="p">(</span><span class="n">itime</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">p</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span><span class="mi">3</span><span class="p">),</span><span class="s2">&quot; cubic meters&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Head End of Timestep </span><span class="se">\n</span><span class="s2"> ----&quot;</span><span class="p">)</span>
        <span class="n">writearray</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--------</span><span class="se">\n</span><span class="s2">--------&quot;</span><span class="p">)</span>
        <span class="n">my_xyz</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
        <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
                <span class="n">my_xyz</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">distancex</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">],</span><span class="n">distancey</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">irow</span><span class="p">],</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]])</span>
        <span class="kn">import</span> <span class="nn">pandas</span>
        <span class="n">my_xyz</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">my_xyz</span><span class="p">)</span> <span class="c1"># convert into a data frame</span>
<span class="c1">#print(my_xyz) # activate to examine the dataframe</span>
        <span class="kn">import</span> <span class="nn">numpy</span> 
        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span>
        <span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>
<span class="c1"># extract lists from the dataframe</span>
        <span class="n">coord_x</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 0 of dataframe</span>
        <span class="n">coord_y</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 1 of dataframe</span>
        <span class="n">coord_z</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 2 of dataframe</span>
        <span class="n">coord_xy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">coord_x</span><span class="p">,</span> <span class="n">coord_y</span><span class="p">))</span>
<span class="c1"># Set plotting range in original data units</span>
        <span class="n">lon</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="mi">300</span><span class="p">)</span>
        <span class="n">lat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="mi">80</span><span class="p">)</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
<span class="c1"># Grid the data; use linear interpolation (choices are nearest, linear, cubic)</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_xy</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_z</span><span class="p">),</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="c1"># Build the map</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
        <span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Head Map at Elapsed Time &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">deltat</span><span class="o">*</span><span class="p">(</span><span class="n">itime</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39; days&#39;</span><span class="p">)</span>
<span class="c1">## End Time Stepping Outer Loop</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;End Simulation&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0xffff5f790200 0xffff5f762080 0xffff5f760680
Elapsed Time  1.0  days
Closure Error =  0.0
Minimum Head 20.0
Pumpage Total -1000000.0  cubic meters
Head End of Timestep 
 ----
0 [20. 20. 20. 20. 20. 20. 20. 20. 20. 20.]
1 [21. 21. 21. 21. 21. 21. 21. 21. 21. 21.]
2 [23. 23. 23. 23. 23. 23. 23. 23. 23. 23.]
3 [29. 29. 29. 29. 29. 29. 29. 29. 29. 29.]
4 [33. 33. 33. 33. 33. 33. 33. 33. 33. 33.]
5 [34. 34. 34. 34. 34. 34. 34. 34. 34. 34.]
6 [34. 34. 34. 34. 34. 34. 34. 34. 34. 34.]
7 [32. 32. 32. 32. 32. 32. 32. 32. 32. 32.]
8 [28. 28. 28. 28. 28. 28. 28. 28. 28. 28.]
9 [20. 20. 20. 20. 20. 20. 20. 20. 20. 20.]
--------
--------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time  1826.0  days
Closure Error =  8.3e-11
Minimum Head 20.0
Pumpage Total -1826000000.0  cubic meters
Head End of Timestep 
 ----
0 [20. 20. 20. 20. 20. 20. 20. 20. 20. 20.]
1 [21. 21. 21. 21. 21. 21. 21. 21. 21. 21.]
2 [23. 23. 23. 23. 23. 23. 23. 23. 23. 23.]
3 [29. 29. 29. 29. 29. 29. 29. 29. 29. 29.]
4 [33. 33. 33. 33. 33. 33. 33. 33. 33. 33.]
5 [34. 34. 34. 34. 34. 34. 34. 34. 34. 34.]
6 [34. 34. 34. 34. 34. 34. 34. 34. 34. 34.]
7 [32. 32. 32. 32. 32. 32. 32. 32. 32. 32.]
8 [28. 28. 28. 28. 28. 28. 28. 28. 28. 28.]
9 [20. 20. 20. 20. 20. 20. 20. 20. 20. 20.]
--------
--------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time  3651.0  days
Closure Error =  8.3e-11
Minimum Head 20.0
Pumpage Total -3651000000.0  cubic meters
Head End of Timestep 
 ----
0 [20. 20. 20. 20. 20. 20. 20. 20. 20. 20.]
1 [21. 21. 21. 21. 21. 21. 21. 21. 21. 21.]
2 [23. 23. 23. 23. 23. 23. 23. 23. 23. 23.]
3 [29. 29. 29. 29. 29. 29. 29. 29. 29. 29.]
4 [33. 33. 33. 33. 33. 33. 33. 33. 33. 33.]
5 [34. 34. 34. 34. 34. 34. 34. 34. 34. 34.]
6 [34. 34. 34. 34. 34. 34. 34. 34. 34. 34.]
7 [32. 32. 32. 32. 32. 32. 32. 32. 32. 32.]
8 [28. 28. 28. 28. 28. 28. 28. 28. 28. 28.]
9 [20. 20. 20. 20. 20. 20. 20. 20. 20. 20.]
--------
--------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time  5476.0  days
Closure Error =  8.3e-11
Minimum Head 20.0
Pumpage Total -5476000000.0  cubic meters
Head End of Timestep 
 ----
0 [20. 20. 20. 20. 20. 20. 20. 20. 20. 20.]
1 [21. 21. 21. 21. 21. 21. 21. 21. 21. 21.]
2 [23. 23. 23. 23. 23. 23. 23. 23. 23. 23.]
3 [29. 29. 29. 29. 29. 29. 29. 29. 29. 29.]
4 [33. 33. 33. 33. 33. 33. 33. 33. 33. 33.]
5 [34. 34. 34. 34. 34. 34. 34. 34. 34. 34.]
6 [34. 34. 34. 34. 34. 34. 34. 34. 34. 34.]
7 [32. 32. 32. 32. 32. 32. 32. 32. 32. 32.]
8 [28. 28. 28. 28. 28. 28. 28. 28. 28. 28.]
9 [20. 20. 20. 20. 20. 20. 20. 20. 20. 20.]
--------
--------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time  7301.0  days
Closure Error =  8.3e-11
Minimum Head 20.0
Pumpage Total -7301000000.0  cubic meters
Head End of Timestep 
 ----
0 [20. 20. 20. 20. 20. 20. 20. 20. 20. 20.]
1 [21. 21. 21. 21. 21. 21. 21. 21. 21. 21.]
2 [23. 23. 23. 23. 23. 23. 23. 23. 23. 23.]
3 [29. 29. 29. 29. 29. 29. 29. 29. 29. 29.]
4 [33. 33. 33. 33. 33. 33. 33. 33. 33. 33.]
5 [34. 34. 34. 34. 34. 34. 34. 34. 34. 34.]
6 [34. 34. 34. 34. 34. 34. 34. 34. 34. 34.]
7 [32. 32. 32. 32. 32. 32. 32. 32. 32. 32.]
8 [28. 28. 28. 28. 28. 28. 28. 28. 28. 28.]
9 [20. 20. 20. 20. 20. 20. 20. 20. 20. 20.]
--------
--------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time  9126.0  days
Closure Error =  8.3e-11
Minimum Head 20.0
Pumpage Total -9126000000.0  cubic meters
Head End of Timestep 
 ----
0 [20. 20. 20. 20. 20. 20. 20. 20. 20. 20.]
1 [21. 21. 21. 21. 21. 21. 21. 21. 21. 21.]
2 [23. 23. 23. 23. 23. 23. 23. 23. 23. 23.]
3 [29. 29. 29. 29. 29. 29. 29. 29. 29. 29.]
4 [33. 33. 33. 33. 33. 33. 33. 33. 33. 33.]
5 [34. 34. 34. 34. 34. 34. 34. 34. 34. 34.]
6 [34. 34. 34. 34. 34. 34. 34. 34. 34. 34.]
7 [32. 32. 32. 32. 32. 32. 32. 32. 32. 32.]
8 [28. 28. 28. 28. 28. 28. 28. 28. 28. 28.]
9 [20. 20. 20. 20. 20. 20. 20. 20. 20. 20.]
--------
--------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>End Simulation
</pre></div>
</div>
<img alt="../../_images/14gwmodels_7_7.png" src="../../_images/14gwmodels_7_7.png" />
<img alt="../../_images/14gwmodels_7_8.png" src="../../_images/14gwmodels_7_8.png" />
<img alt="../../_images/14gwmodels_7_9.png" src="../../_images/14gwmodels_7_9.png" />
<img alt="../../_images/14gwmodels_7_10.png" src="../../_images/14gwmodels_7_10.png" />
<img alt="../../_images/14gwmodels_7_11.png" src="../../_images/14gwmodels_7_11.png" />
<img alt="../../_images/14gwmodels_7_12.png" src="../../_images/14gwmodels_7_12.png" />
</div>
</div>
<p>The results above are the pre-development conditions. The file was created by running the script once with all the heads set to 20. Then at the end of the run (30 years), the output heads were pasted back into the input file, and it was rerun. This process was repeated several times until the program ran through all the time steps using only a single iteration and the error term essentially reported as a small constant value. At this condition, the system was deemed to be at equilibrium.</p>
<p>Examination of the output shows that the contour lines are parallel to the swamp and the river (bottom and top) and slope from the middle (Y == 5500 meters) towards each boundary. The highest plotted water elevation is 34 meters, which would be a depth of about 6 meters beneath the town of Hubbleville. The high “ridge” is called a groundwater divide. All water South of the divide flows to the swamp, whereas all water North of the divide flows to the river.</p>
<p>Now we will activate the pumping. The pumping rate is positive 210,000 cubic meters per day. The recharge rate is a negative 10,000 cubic meters per day, so net pumping is 190,000 cubic meters per day. We will change the contents of the single well field cell, rename the file, and rerun the script.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">reset</span> -f

<span class="k">def</span> <span class="nf">sse</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">sse</span><span class="o">=</span><span class="mf">0.0</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">sse</span><span class="o">=</span><span class="n">sse</span><span class="o">+</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">-</span><span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span><span class="p">(</span><span class="n">sse</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="c1">##print(nr,nc)</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="c1">##print(ir,jc)</span>
            <span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">=</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span>
    <span class="k">return</span><span class="p">(</span><span class="n">matrix2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">writearray</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="n">new_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">),</span> <span class="mi">0</span><span class="p">))</span>    
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">new_list</span><span class="p">[</span><span class="n">ir</span><span class="p">][:])</span>
    <span class="k">return</span><span class="p">()</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="n">localfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;input8M.txt&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="c1"># connect and read file for 2D gw model</span>
<span class="n">deltax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltay</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltaz</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltat</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span> <span class="c1"># time step</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">tolerance</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">maxiter</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span> <span class="c1"># max iter per time step</span>
<span class="n">maxtime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span> <span class="c1"># total time steps</span>
<span class="n">iprint</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span> <span class="c1"># output every iprint steps</span>
<span class="n">distancex</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancex</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">distancey</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancey</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarytop</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarytop</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarybottom</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarybottom</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryleft</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryleft</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryright</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryright</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">head</span> <span class="o">=</span><span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">head</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1">#writearray(head)</span>
<span class="n">hydcondx</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondx</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1">#writearray(hydcondx)</span>
<span class="n">hydcondy</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondy</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1">#writearray(hydcondy)</span>
<span class="n">storage</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">storage</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1">#writearray(storage)</span>
<span class="n">pumping</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">pumping</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1">#writearray(pumping)</span>
<span class="n">localfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="c1"># Disconnect the file</span>
<span class="c1">##</span>
<span class="n">amat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">bmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">cmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">dmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">qrat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="c1">## Net Pumping Array</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="n">qrat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">deltat</span><span class="o">*</span><span class="n">pumping</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">])</span> <span class="o">/</span><span class="p">(</span><span class="n">deltax</span><span class="o">*</span><span class="n">deltay</span><span class="o">*</span><span class="n">storage</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">])</span>
<span class="c1">## Headold array initialize</span>
<span class="n">headold</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span> <span class="c1">#force a new matrix</span>
<span class="n">headnew</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span> <span class="c1"># element-by-element assignment</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="n">headold</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span>
        <span class="n">headnew</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">head</span><span class="p">)),</span><span class="nb">hex</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">headold</span><span class="p">)),</span><span class="nb">hex</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">headnew</span><span class="p">)))</span>

<span class="c1">## Time Stepping Outer Loop</span>
<span class="k">for</span> <span class="n">itime</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxtime</span><span class="p">):</span>

<span class="c1">#### Single Time Step Update Loop</span>
    <span class="n">tolflag</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxiter</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
                <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="n">headnew</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span>
<span class="c1"># Boundary Conditions</span>
<span class="c1">## Transmissivity Arrays</span>
        <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> <span class="o">*</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> <span class="o">*</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> <span class="o">*</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> <span class="o">*</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span> <span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> <span class="o">*</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> <span class="o">*</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Boundary Conditions</span>
<span class="c1"># first and last row special == no flow boundaries</span>
        <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">boundarytop</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at top</span>
                <span class="n">head</span> <span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
            <span class="k">if</span> <span class="n">boundarybottom</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">jcol</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at bottom</span>
                <span class="n">head</span> <span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
<span class="c1"># first and last column special == no flow boundaries     </span>
        <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span> 
            <span class="k">if</span>  <span class="n">boundaryleft</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># no - flow at left</span>
            <span class="k">if</span> <span class="n">boundaryright</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
                <span class="n">head</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span> <span class="n">irow</span> <span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># no - flow at right</span>
<span class="c1"># interior updates</span>
        <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span> <span class="p">(</span><span class="n">headold</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">+</span> <span class="n">qrat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> 
                                   <span class="o">+</span><span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span>
                                   <span class="o">+</span><span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                                   <span class="o">+</span><span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
                                   <span class="o">+</span><span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">amat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">bmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">cmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">dmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">+</span><span class="mf">1.0</span><span class="p">)</span>

<span class="c1"># test for stopping iterations</span>
        <span class="n">percentdiff</span> <span class="o">=</span> <span class="n">sse</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headnew</span><span class="p">)</span>
        <span class="k">if</span>  <span class="n">percentdiff</span> <span class="o">&lt;=</span> <span class="n">tolerance</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
                <span class="n">headnew</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span>
<span class="c1">### End Single Step Update Loop</span>
<span class="c1"># update values at end of a time step</span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
            <span class="n">headold</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">itime</span> <span class="o">%</span> <span class="n">iprint</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elapsed Time &quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">deltat</span><span class="o">*</span><span class="p">(</span><span class="n">itime</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">),</span><span class="s2">&quot; days&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Closure Error = &quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">percentdiff</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pumping</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Minimum Head&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span><span class="mi">3</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pumpage Total&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">deltat</span><span class="o">*</span><span class="p">(</span><span class="n">itime</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">p</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span><span class="mi">3</span><span class="p">),</span><span class="s2">&quot; cubic meters&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Head End of Timestep </span><span class="se">\n</span><span class="s2"> ----&quot;</span><span class="p">)</span>
        <span class="n">writearray</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--------</span><span class="se">\n</span><span class="s2">--------&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">head</span><span class="p">)),</span><span class="nb">hex</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">headold</span><span class="p">)))</span>
        <span class="n">my_xyz</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
        <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
                <span class="n">my_xyz</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">distancex</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">],</span><span class="n">distancey</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">irow</span><span class="p">],</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]])</span>
        <span class="kn">import</span> <span class="nn">pandas</span>
        <span class="n">my_xyz</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">my_xyz</span><span class="p">)</span> <span class="c1"># convert into a data frame</span>
<span class="c1">#print(my_xyz) # activate to examine the dataframe</span>
        <span class="kn">import</span> <span class="nn">numpy</span> 
        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span>
        <span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>
<span class="c1"># extract lists from the dataframe</span>
        <span class="n">coord_x</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 0 of dataframe</span>
        <span class="n">coord_y</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 1 of dataframe</span>
        <span class="n">coord_z</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 2 of dataframe</span>
        <span class="n">coord_xy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">coord_x</span><span class="p">,</span> <span class="n">coord_y</span><span class="p">))</span>
<span class="c1"># Set plotting range in original data units</span>
        <span class="n">lon</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="mi">300</span><span class="p">)</span>
        <span class="n">lat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="mi">80</span><span class="p">)</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
<span class="c1"># Grid the data; use linear interpolation (choices are nearest, linear, cubic)</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_xy</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_z</span><span class="p">),</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="c1"># Build the map</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
        <span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Head Map at Elapsed Time &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">deltat</span><span class="o">*</span><span class="p">(</span><span class="n">itime</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39; days&#39;</span><span class="p">)</span>
<span class="c1">## End Time Stepping Outer Loop</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;End Simulation&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0xffff5f89c8c0 0xffff5f889640 0xffff5f889680
Elapsed Time  1.0  days
Closure Error =  0.000171892321
Minimum Head 20.0
Pumpage Total -780000.0  cubic meters
Head End of Timestep 
 ----
0 [20. 20. 20. 20. 20. 20. 20. 20. 20. 20.]
1 [21. 21. 21. 21. 21. 21. 21. 21. 21. 21.]
2 [23. 23. 23. 23. 23. 23. 23. 23. 23. 23.]
3 [29. 29. 29. 29. 29. 29. 29. 29. 29. 29.]
4 [33. 33. 33. 33. 33. 33. 33. 33. 33. 33.]
5 [34. 34. 34. 34. 34. 34. 34. 34. 34. 34.]
6 [34. 34. 34. 34. 33. 34. 34. 34. 34. 34.]
7 [32. 32. 32. 32. 32. 32. 32. 32. 32. 32.]
8 [28. 28. 28. 28. 28. 28. 28. 28. 28. 28.]
9 [20. 20. 20. 20. 20. 20. 20. 20. 20. 20.]
--------
--------
0xffff5f89c8c0 0xffff5f889640
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time  3651.0  days
Closure Error =  2.134826e-06
Minimum Head 14.238
Pumpage Total -2847780000.0  cubic meters
Head End of Timestep 
 ----
0 [20. 20. 20. 20. 20. 20. 20. 20. 20. 20.]
1 [21. 21. 21. 21. 21. 21. 21. 21. 21. 21.]
2 [23. 23. 23. 23. 23. 23. 23. 23. 23. 23.]
3 [30. 30. 29. 29. 29. 29. 30. 30. 30. 30.]
4 [33. 33. 32. 32. 31. 32. 33. 34. 34. 34.]
5 [34. 34. 33. 31. 29. 31. 33. 35. 35. 35.]
6 [33. 33. 32. 28. 14. 28. 32. 34. 35. 35.]
7 [31. 31. 30. 28. 26. 29. 31. 32. 33. 33.]
8 [27. 27. 27. 26. 25. 26. 27. 28. 28. 28.]
9 [20. 20. 20. 20. 20. 20. 20. 20. 20. 20.]
--------
--------
0xffff5f89c8c0 0xffff5f889640
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time  7301.0  days
Closure Error =  0.000741421151
Minimum Head 10.672
Pumpage Total -5694780000.0  cubic meters
Head End of Timestep 
 ----
0 [20. 20. 20. 20. 20. 20. 20. 20. 20. 20.]
1 [21. 21. 21. 21. 21. 21. 21. 21. 21. 21.]
2 [23. 23. 23. 23. 23. 23. 23. 23. 23. 23.]
3 [29. 29. 29. 28. 28. 28. 29. 29. 29. 29.]
4 [32. 32. 31. 30. 30. 30. 32. 32. 33. 33.]
5 [32. 32. 32. 30. 27. 30. 32. 33. 34. 34.]
6 [32. 32. 30. 27. 11. 27. 31. 33. 34. 34.]
7 [30. 30. 29. 27. 24. 27. 30. 31. 32. 32.]
8 [27. 27. 26. 25. 25. 25. 26. 27. 27. 27.]
9 [20. 20. 20. 20. 20. 20. 20. 20. 20. 20.]
--------
--------
0xffff5f89c8c0 0xffff5f889640
</pre></div>
</div>
</div>
</div>
<p>The simulation above is the result of the change. The plot is promising because the slope of the
water is still towards the swamp. However, if we examine the plot at 40 years we will
discover we have dewatered the aquifer in the wellfield (at some point the wells would fail). So we can conclude that the swamp is safe, but the town of Hubbleville cannot realistically recover the amount of water they desire.
While we have the model available, we can try different pumping rates to see how much firm yield the town could expect. For the example, lets stipulate that the smallest allowable head in the well field is 5 meters. Our goal is now to determine how large a pumping rate we can use and keep the head at this location greater than 5 meters. The exercise is quite simple, we will change the pumping value and run the script and examine the output. If the head is too small, decrease the pumping, if the head is too large then increase the pumping and we stop when it is just right.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Goldilocks optimization!</p>
</div>
<p>By some trial-and-error a net puming rate of 179,930 at Hubbleville preserves the minimum head in the aquifer and delivers a good quantity of water.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The numerical values in these examples are entirely invented, 20,000 cubic meters per day is about 3600 gallons per minute, not an unreasonable value but absurd for a mere 5 meters of saturated thickness.  Professional tools like <code class="docutils literal notranslate"><span class="pre">MODFLOW</span></code> do internal error checks to reduce the ability to process absurd values.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">reset</span> -f

<span class="k">def</span> <span class="nf">sse</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">sse</span><span class="o">=</span><span class="mf">0.0</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">sse</span><span class="o">=</span><span class="n">sse</span><span class="o">+</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">-</span><span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span><span class="p">(</span><span class="n">sse</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="c1">##print(nr,nc)</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="c1">##print(ir,jc)</span>
            <span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">=</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span>
    <span class="k">return</span><span class="p">(</span><span class="n">matrix2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">writearray</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="n">new_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">),</span> <span class="mi">0</span><span class="p">))</span>    
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">new_list</span><span class="p">[</span><span class="n">ir</span><span class="p">][:])</span>
    <span class="k">return</span><span class="p">()</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="n">localfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;input8M2.txt&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="c1"># connect and read file for 2D gw model</span>
<span class="n">deltax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltay</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltaz</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltat</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span> <span class="c1"># time step</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">tolerance</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">maxiter</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span> <span class="c1"># max iter per time step</span>
<span class="n">maxtime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span> <span class="c1"># total time steps</span>
<span class="n">iprint</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span> <span class="c1"># output every iprint steps</span>
<span class="n">distancex</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancex</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">distancey</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancey</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarytop</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarytop</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarybottom</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarybottom</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryleft</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryleft</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryright</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryright</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">head</span> <span class="o">=</span><span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">head</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1">#writearray(head)</span>
<span class="n">hydcondx</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondx</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1">#writearray(hydcondx)</span>
<span class="n">hydcondy</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondy</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1">#writearray(hydcondy)</span>
<span class="n">storage</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">storage</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1">#writearray(storage)</span>
<span class="n">pumping</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">pumping</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1">#writearray(pumping)</span>
<span class="n">localfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="c1"># Disconnect the file</span>
<span class="c1">##</span>
<span class="n">amat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">bmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">cmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">dmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">qrat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="c1">## Net Pumping Array</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="n">qrat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">deltat</span><span class="o">*</span><span class="n">pumping</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">])</span> <span class="o">/</span><span class="p">(</span><span class="n">deltax</span><span class="o">*</span><span class="n">deltay</span><span class="o">*</span><span class="n">storage</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">])</span>
<span class="c1">## Headold array initialize</span>
<span class="n">headold</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span> <span class="c1">#force a new matrix</span>
<span class="n">headnew</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span> <span class="c1"># element-by-element assignment</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="n">headold</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span>
        <span class="n">headnew</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">head</span><span class="p">)),</span><span class="nb">hex</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">headold</span><span class="p">)),</span><span class="nb">hex</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">headnew</span><span class="p">)))</span>

<span class="c1">## Time Stepping Outer Loop</span>
<span class="k">for</span> <span class="n">itime</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxtime</span><span class="p">):</span>

<span class="c1">#### Single Time Step Update Loop</span>
    <span class="n">tolflag</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxiter</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
                <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="n">headnew</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span>
<span class="c1"># Boundary Conditions</span>
<span class="c1">## Transmissivity Arrays</span>
        <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> <span class="o">*</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> <span class="o">*</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> <span class="o">*</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> <span class="o">*</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span> <span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> <span class="o">*</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> <span class="o">*</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Boundary Conditions</span>
<span class="c1"># first and last row special == no flow boundaries</span>
        <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">boundarytop</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at top</span>
                <span class="n">head</span> <span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
            <span class="k">if</span> <span class="n">boundarybottom</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">jcol</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at bottom</span>
                <span class="n">head</span> <span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
<span class="c1"># first and last column special == no flow boundaries     </span>
        <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span> 
            <span class="k">if</span>  <span class="n">boundaryleft</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># no - flow at left</span>
            <span class="k">if</span> <span class="n">boundaryright</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
                <span class="n">head</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span> <span class="n">irow</span> <span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># no - flow at right</span>
<span class="c1"># interior updates</span>
        <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span> <span class="p">(</span><span class="n">headold</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">+</span> <span class="n">qrat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> 
                                   <span class="o">+</span><span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span>
                                   <span class="o">+</span><span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                                   <span class="o">+</span><span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
                                   <span class="o">+</span><span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">amat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">bmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">cmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">dmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">+</span><span class="mf">1.0</span><span class="p">)</span>

<span class="c1"># test for stopping iterations</span>
        <span class="n">percentdiff</span> <span class="o">=</span> <span class="n">sse</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headnew</span><span class="p">)</span>
        <span class="k">if</span>  <span class="n">percentdiff</span> <span class="o">&lt;=</span> <span class="n">tolerance</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
                <span class="n">headnew</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span>
<span class="c1">### End Single Step Update Loop</span>
<span class="c1"># update values at end of a time step</span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
            <span class="n">headold</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">itime</span> <span class="o">%</span> <span class="n">iprint</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elapsed Time &quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">deltat</span><span class="o">*</span><span class="p">(</span><span class="n">itime</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">),</span><span class="s2">&quot; days&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Closure Error = &quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">percentdiff</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pumping</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Minimum Head&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span><span class="mi">3</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pumpage Total&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">deltat</span><span class="o">*</span><span class="p">(</span><span class="n">itime</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">p</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span><span class="mi">3</span><span class="p">),</span><span class="s2">&quot; cubic meters&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Head End of Timestep </span><span class="se">\n</span><span class="s2"> ----&quot;</span><span class="p">)</span>
        <span class="n">writearray</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--------</span><span class="se">\n</span><span class="s2">--------&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">head</span><span class="p">)),</span><span class="nb">hex</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">headold</span><span class="p">)),</span><span class="nb">hex</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">headnew</span><span class="p">)))</span>
        <span class="n">my_xyz</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
        <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
                <span class="n">my_xyz</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">distancex</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">],</span><span class="n">distancey</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">irow</span><span class="p">],</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]])</span>
        <span class="kn">import</span> <span class="nn">pandas</span>
        <span class="n">my_xyz</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">my_xyz</span><span class="p">)</span> <span class="c1"># convert into a data frame</span>
<span class="c1">#print(my_xyz) # activate to examine the dataframe</span>
        <span class="kn">import</span> <span class="nn">numpy</span> 
        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span>
        <span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>
<span class="c1"># extract lists from the dataframe</span>
        <span class="n">coord_x</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 0 of dataframe</span>
        <span class="n">coord_y</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 1 of dataframe</span>
        <span class="n">coord_z</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 2 of dataframe</span>
        <span class="n">coord_xy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">coord_x</span><span class="p">,</span> <span class="n">coord_y</span><span class="p">))</span>
<span class="c1"># Set plotting range in original data units</span>
        <span class="n">lon</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="mi">300</span><span class="p">)</span>
        <span class="n">lat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="mi">80</span><span class="p">)</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
<span class="c1"># Grid the data; use linear interpolation (choices are nearest, linear, cubic)</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_xy</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_z</span><span class="p">),</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="c1"># Build the map</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
        <span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Head Map at Elapsed Time &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">deltat</span><span class="o">*</span><span class="p">(</span><span class="n">itime</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39; days&#39;</span><span class="p">)</span>
<span class="c1">## End Time Stepping Outer Loop</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;End Simulation&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0xffff628ac8c0 0xffff62c440c0 0xffff62c44a80
Elapsed Time  1.0  days
Closure Error =  0.000128377356
Minimum Head 20.0
Pumpage Total -810070.0  cubic meters
Head End of Timestep 
 ----
0 [20. 20. 20. 20. 20. 20. 20. 20. 20. 20.]
1 [21. 21. 21. 21. 21. 21. 21. 21. 21. 21.]
2 [23. 23. 23. 23. 23. 23. 23. 23. 23. 23.]
3 [29. 29. 29. 29. 29. 29. 29. 29. 29. 29.]
4 [33. 33. 33. 33. 33. 33. 33. 33. 33. 33.]
5 [34. 34. 34. 34. 34. 34. 34. 34. 34. 34.]
6 [34. 34. 34. 34. 33. 34. 34. 34. 34. 34.]
7 [32. 32. 32. 32. 32. 32. 32. 32. 32. 32.]
8 [28. 28. 28. 28. 28. 28. 28. 28. 28. 28.]
9 [20. 20. 20. 20. 20. 20. 20. 20. 20. 20.]
--------
--------
0xffff628ac8c0 0xffff62c440c0 0xffff62c44a80
Elapsed Time  3651.0  days
Closure Error =  0.000989972792
Minimum Head 5.005
Pumpage Total -2957565570.0  cubic meters
Head End of Timestep 
 ----
0 [20. 20. 20. 20. 20. 20. 20. 20. 20. 20.]
1 [21. 21. 21. 21. 21. 21. 21. 21. 21. 21.]
2 [22. 22. 22. 22. 22. 22. 23. 23. 23. 23.]
3 [27. 27. 27. 26. 26. 26. 27. 27. 28. 28.]
4 [29. 29. 28. 28. 27. 28. 29. 30. 30. 30.]
5 [29. 29. 28. 26. 24. 27. 29. 30. 31. 31.]
6 [29. 29. 27. 23.  5. 24. 28. 30. 31. 31.]
7 [28. 28. 27. 25. 22. 25. 27. 28. 29. 29.]
8 [25. 25. 25. 24. 23. 24. 25. 26. 26. 26.]
9 [20. 20. 20. 20. 20. 20. 20. 20. 20. 20.]
--------
--------
0xffff628ac8c0 0xffff62c440c0 0xffff62c44a80
Elapsed Time  7301.0  days
Closure Error =  0.000989972792
Minimum Head 5.005
Pumpage Total -5914321070.0  cubic meters
Head End of Timestep 
 ----
0 [20. 20. 20. 20. 20. 20. 20. 20. 20. 20.]
1 [21. 21. 21. 21. 21. 21. 21. 21. 21. 21.]
2 [22. 22. 22. 22. 22. 22. 23. 23. 23. 23.]
3 [27. 27. 27. 26. 26. 26. 27. 27. 28. 28.]
4 [29. 29. 28. 28. 27. 28. 29. 30. 30. 30.]
5 [29. 29. 28. 26. 24. 27. 29. 30. 31. 31.]
6 [29. 29. 27. 23.  5. 24. 28. 30. 31. 31.]
7 [28. 28. 27. 25. 22. 25. 27. 28. 29. 29.]
8 [25. 25. 25. 24. 23. 24. 25. 26. 26. 26.]
9 [20. 20. 20. 20. 20. 20. 20. 20. 20. 20.]
--------
--------
0xffff628ac8c0 0xffff62c440c0 0xffff62c44a80
Elapsed Time  10951.0  days
Closure Error =  0.000989972792
Minimum Head 5.005
Pumpage Total -8871076570.0  cubic meters
Head End of Timestep 
 ----
0 [20. 20. 20. 20. 20. 20. 20. 20. 20. 20.]
1 [21. 21. 21. 21. 21. 21. 21. 21. 21. 21.]
2 [22. 22. 22. 22. 22. 22. 23. 23. 23. 23.]
3 [27. 27. 27. 26. 26. 26. 27. 27. 28. 28.]
4 [29. 29. 28. 28. 27. 28. 29. 30. 30. 30.]
5 [29. 29. 28. 26. 24. 27. 29. 30. 31. 31.]
6 [29. 29. 27. 23.  5. 24. 28. 30. 31. 31.]
7 [28. 28. 27. 25. 22. 25. 27. 28. 29. 29.]
8 [25. 25. 25. 24. 23. 24. 25. 26. 26. 26.]
9 [20. 20. 20. 20. 20. 20. 20. 20. 20. 20.]
--------
--------
0xffff628ac8c0 0xffff62c440c0 0xffff62c44a80
Elapsed Time  14601.0  days
Closure Error =  0.000989972792
Minimum Head 5.005
Pumpage Total -11827832070.0  cubic meters
Head End of Timestep 
 ----
0 [20. 20. 20. 20. 20. 20. 20. 20. 20. 20.]
1 [21. 21. 21. 21. 21. 21. 21. 21. 21. 21.]
2 [22. 22. 22. 22. 22. 22. 23. 23. 23. 23.]
3 [27. 27. 27. 26. 26. 26. 27. 27. 28. 28.]
4 [29. 29. 28. 28. 27. 28. 29. 30. 30. 30.]
5 [29. 29. 28. 26. 24. 27. 29. 30. 31. 31.]
6 [29. 29. 27. 23.  5. 24. 28. 30. 31. 31.]
7 [28. 28. 27. 25. 22. 25. 27. 28. 29. 29.]
8 [25. 25. 25. 24. 23. 24. 25. 26. 26. 26.]
9 [20. 20. 20. 20. 20. 20. 20. 20. 20. 20.]
--------
--------
0xffff628ac8c0 0xffff62c440c0 0xffff62c44a80
End Simulation
</pre></div>
</div>
<img alt="../../_images/14gwmodels_11_1.png" src="../../_images/14gwmodels_11_1.png" />
<img alt="../../_images/14gwmodels_11_2.png" src="../../_images/14gwmodels_11_2.png" />
<img alt="../../_images/14gwmodels_11_3.png" src="../../_images/14gwmodels_11_3.png" />
<img alt="../../_images/14gwmodels_11_4.png" src="../../_images/14gwmodels_11_4.png" />
</div>
</div>
<p>These examples introduced an important computational hydraulics problem – namely that of flow in a porous medium. The governing equation of motion is Darcy’s law. We computed the heads using a variety of methods, but mostly focused on Jacobi iteration because for these kinds of problems it is a stable solution technique. It is not particularly computationally efficient, but it works.</p>
<p>Focus was also on code reuse so the reader can look back over the examples and see the evolution of the code as the problem got more complex.</p>
<p>Most importantly, while not apparent, we have replicated much of the internal functionality of the professional code <code class="docutils literal notranslate"><span class="pre">MODFLOW</span></code> which we could compare our work to if we had to use the script for something the professional code does not do easily. The scripts here are very crude – to professionalize them we would want to add the concept of “layers” so we could do 3D models, and want to generalize the file reading components of the tool. We would also want to move much of the computation engine components into their own prototype functions so the structure of the program is easier to understand and maintain. Nevertheless, if you have worked this far, you have seen what’s under the hood of a groundwater flow code.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./lessons/groundwatermodels"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="13gwmodels.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Groundwater Models</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="15gwmodels.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">MODFLOW Program</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Theodore G. Cleveland, Ph.D., P.E., M.ASCE, F.EWRI<br/>
        
            &copy; Copyright 2023.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>